"use strict";(self.webpackChunkipyaladin=self.webpackChunkipyaladin||[]).push([[563],{563:(t,e,s)=>{s.r(e),s.d(e,{aladinWidgetPlugin:()=>r,default:()=>m});var i=s(672);const a=JSON.parse('{"u2":"ipyaladin","i8":"0.2.5"}');s(297);const l=(t,e=!0,s="text/javascript")=>new Promise(((i,a)=>{try{const l=document.createElement("script");l.type=s,l.async=e,l.src=t,l.addEventListener("load",(t=>{i({status:!0})})),l.addEventListener("error",(t=>{a({status:!1,message:"Failed to load the script ï¼„{FILE_URL}"})})),document.getElementsByTagName("head")[0].appendChild(l)}catch(t){a(t)}}));let o=l("https://code.jquery.com/jquery-3.6.1.min.js").then((()=>l("https://aladin.u-strasbg.fr/AladinLite/api/v3/latest/aladin.js"))).then((async()=>{await A.init}));class h extends i.DOMWidgetModel{defaults(){return{...super.defaults(),_model_name:"AladinModel",_view_name:"AladinView",_model_module:a.u2,_view_module:a.u2,_model_module_version:a.i8,_view_module_version:a.i8}}}let d=0;class n extends i.DOMWidgetView{render(){o.then((()=>{this.fov_js=!1,this.fov_py=!1,this.target_js=!1,this.target_py=!1,this.div&&this.el.remove(this.div),this.div=document.createElement("div"),this.div.id="aladin-lite-div"+parseInt(d),d+=1;let t=this.model.get("height");this.div.setAttribute("style","width:100%;height:"+t+"px;");let e={},s=this.model.get("options");for(let t of s)e[this.convert_pyname_to_jsname(t)]=this.model.get(t);new MutationObserver((t=>{t.forEach((t=>{t.addedNodes.forEach((t=>{t.id==this.div.id&&setTimeout((()=>{this.al=A.aladin([this.div],e),this.aladin_events(),this.model_events()}),1e3)}))}))})).observe(this.el,{subtree:!1,childList:!0}),this.el.appendChild(this.div)}))}convert_pyname_to_jsname(t){let e=t.split("_");for(let t=1;t<e.length;t++)e[t]=e[t].charAt(0).toUpperCase()+e[t].slice(1);return e.join("")}aladin_events(){this.al.on("zoomChanged",(t=>{this.fov_py?this.fov_py=!1:(this.fov_js=!0,this.model.set("fov",parseFloat(t.toFixed(5))),this.touch())})),this.al.on("positionChanged",(t=>{this.target_py?this.target_py=!1:(this.target_js=!0,this.model.set("target",t.ra.toFixed(6)+" "+t.dec.toFixed(6)),this.touch())}))}model_events(){this.listenTo(this.model,"change:fov",(()=>{this.fov_js?this.fov_js=!1:(this.fov_py=!0,this.al.setFoV(this.model.get("fov")))}),this),this.listenTo(this.model,"change:target",(()=>{this.target_js?this.target_js=!1:(this.target_py=!0,this.al.gotoObject(this.model.get("target")))}),this),this.listenTo(this.model,"change:coo_frame",(()=>{this.al.setFrame(this.model.get("coo_frame"))}),this),this.listenTo(this.model,"change:height",(()=>{let t=this.model.get("height");this.div.setAttribute("style","width:100%;height:"+t+"px;")}),this),this.listenTo(this.model,"change:survey",(()=>{this.al.setImageSurvey(this.model.get("survey"))}),this),this.listenTo(this.model,"change:overlay_survey",(()=>{this.al.setOverlayImageLayer(this.model.get("overlay_survey"))}),this),this.listenTo(this.model,"change:overlay_survey_opacity",(()=>{this.al.getOverlayImageLayer().setAlpha(this.model.get("overlay_survey_opacity"))}),this),this.listenTo(this.model,"change:votable_from_URL_flag",(()=>{this.al.addCatalog(A.catalogFromURL(this.model.get("votable_URL"),this.model.get("votable_options")))}),this),this.listenTo(this.model,"change:moc_from_URL_flag",(()=>{this.al.addMOC(A.MOCFromURL(this.model.get("moc_URL"),this.model.get("moc_options")))}),this),this.listenTo(this.model,"change:moc_from_dict_flag",(()=>{this.al.addMOC(A.MOCFromJSON(this.model.get("moc_dict"),this.model.get("moc_options")))}),this),this.listenTo(this.model,"change:table_flag",(()=>{let t=A.catalog({onClick:"showTable"});this.al.addCatalog(t),t.addSourcesAsArray(this.model.get("table_keys"),this.model.get("table_columns"))}),this),this.listenTo(this.model,"change:overlay_from_stcs_flag",(()=>{let t=A.graphicOverlay(this.model.get("overlay_options"));this.al.addOverlay(t),t.addFootprints(A.footprintsFromSTCS(this.model.get("stc_string")))}),this),this.listenTo(this.model,"change:listener_flag",(()=>{let t=this.model.get("listener_type");this.al.on(t,(e=>{if("select"!==t)e&&this.send({event:"callback",type:t,data:{data:e.data,dec:e.dec,ra:e.ra,x:e.x,y:e.y}});else{let s=e;for(let t of this.al.view.catalogs)t.deselectAll();let i=[];for(let t of s)t.select(),i.push({data:t.data,dec:t.dec,ra:t.ra,x:t.x,y:t.y});this.send({event:"callback",type:t,data:i})}}))}),this),this.listenTo(this.model,"change:rectangular_selection_flag",(()=>{this.al.select()})),this.listenTo(this.model,"change:thumbnail_flag",(()=>{this.al.exportAsPNG()})),this.listenTo(this.model,"change:color_map_flag",(()=>{const t=this.model.get("color_map_name");this.al.getBaseImageLayer().setColormap(t)}))}}const r={id:"ipyaladin:plugin",requires:[i.IJupyterWidgetRegistry],activate:function(t,e){e.registerWidget({name:"ipyaladin",version:a.i8,exports:{AladinModel:h,AladinView:n}})},autoStart:!0},m=r}}]);