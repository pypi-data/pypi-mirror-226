(self.webpackChunkjupysql_plugin=self.webpackChunkjupysql_plugin||[]).push([[768],{6768:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MODULE_NAME:()=>U,MODULE_VERSION:()=>B,default:()=>ee});var o={};n.r(o),n.d(o,{FormModel:()=>J,FormView:()=>z});var i={};n.r(i),n.d(i,{TableModel:()=>G,TableView:()=>K});var l={};n.r(l),n.d(l,{ConnectorModel:()=>Y,ConnectorView:()=>Q});var a=n(127),s=n(9235),r=n(2297);class c{constructor(e,t,n){var o,i;this.app=e,this.tracker=t,this.code_mirror=n,null===(i=null===(o=this.tracker)||void 0===o?void 0:o.activeCellChanged)||void 0===i||i.connect((()=>{var e;if(null!==(null===(e=this.tracker)||void 0===e?void 0:e.activeCell)){const e=this.tracker.activeCell;if(null!==e&&"code"===(null==e?void 0:e.model.type)){const t=null==e?void 0:e.editor,n=r.debounce((()=>{var e;const n=null===(e=t.getLine(t.firstLine()))||void 0===e?void 0:e.trim();(null==n?void 0:n.startsWith("%%sql"))?t.editor.setOption("mode","text/x-sql"):t.editor.setOption("mode","text/x-ipython")}),300);t.editor.on("change",n),n()}}}))}}const d={id:"@ploomber/sql-syntax-highlighting",autoStart:!0,requires:[a.INotebookTracker,s.ICodeMirror],optional:[],activate:function(e,t,n){new c(e,t,n),console.log("SQLCodeMirror loaded.")}};var u,m=n(3792),p=n(6548);class v extends p.DataConnector{constructor(e){super(),this._connectors=e}fetch(e){return Promise.all(this._connectors.map((t=>t.fetch(e)))).then((e=>{const t=e.filter((e=>!!e));return u.mergeReplies(t)}))}}!function(e){e.mergeReplies=function(e){const t=e.filter((e=>e.matches.length>0));if(0===t.length)return e[0];if(1===t.length)return t[0];const n=new Set;return t.forEach((e=>{e.matches.forEach((e=>n.add(e)))})),{...t[0],matches:[...n]}}}(u||(u={}));const h=JSON.parse('{"H":[{"value":"ADD"},{"value":"ADD CONSTRAINT"},{"value":"ALL"},{"value":"ALTER"},{"value":"ALTER COLUMN"},{"value":"ALTER TABLE"},{"value":"AND"},{"value":"ANY"},{"value":"AS"},{"value":"ASC"},{"value":"BACKUP DATABASE"},{"value":"BETWEEN"},{"value":"CASE"},{"value":"CHECK"},{"value":"COLUMN"},{"value":"CONSTRAINT"},{"value":"CREATE"},{"value":"CREATE DATABASE"},{"value":"CREATE INDEX"},{"value":"CREATE OR REPLACE VIEW"},{"value":"CREATE TABLE"},{"value":"CREATE PROCEDURE"},{"value":"CREATE UNIQUE INDEX"},{"value":"CREATE VIEW"},{"value":"DATABASE"},{"value":"DEFAULT"},{"value":"DELETE"},{"value":"DESC"},{"value":"DISTINCT"},{"value":"DROP"},{"value":"DROP COLUMN"},{"value":"DROP CONSTRAINT"},{"value":"DROP DATABASE"},{"value":"DROP DEFAULT"},{"value":"DROP INDEX"},{"value":"DROP TABLE"},{"value":"DROP VIEW"},{"value":"EXEC"},{"value":"EXISTS"},{"value":"FOREIGN KEY"},{"value":"FROM"},{"value":"FULL OUTER JOIN"},{"value":"GROUP BY"},{"value":"HAVING"},{"value":"IN"},{"value":"INDEX"},{"value":"INNER JOIN"},{"value":"INSERT INTO"},{"value":"INSERT INTO SELECT"},{"value":"IS NULL"},{"value":"IS NOT NULL"},{"value":"JOIN"},{"value":"LEFT JOIN"},{"value":"LIKE"},{"value":"LIMIT"},{"value":"NOT"},{"value":"NOT NULL"},{"value":"OR"},{"value":"ORDER BY"},{"value":"OUTER JOIN"},{"value":"PRIMARY KEY"},{"value":"PROCEDURE"},{"value":"RIGHT JOIN"},{"value":"ROWNUM"},{"value":"SELECT"},{"value":"SELECT DISTINCT"},{"value":"SELECT INTO"},{"value":"SELECT TOP"},{"value":"SET"},{"value":"TABLE"},{"value":"TOP"},{"value":"TRUNCATE TABLE"},{"value":"UNION"},{"value":"UNION ALL"},{"value":"UNIQUE"},{"value":"UPDATE"},{"value":"VALUES"},{"value":"VIEW"},{"value":"WHERE"}]}');class g extends p.DataConnector{constructor(e){super(),this._editor=e.editor,this._sessionContext=e.sessionContext}fetch(e){return this._editor?new Promise((e=>{e(b.completionHint(this._editor,this._sessionContext))})):Promise.reject("No editor")}}var b,y;!function(e){e.completionHint=function(e,t){const n=e.getCursorPosition(),o=e.getTokenForPosition(n),i=h.H.filter((e=>e.value.startsWith(o.value.toUpperCase()))).map((e=>e.value)),l=Array.from(new Set(i));return{start:o.offset,end:o.offset+o.value.length,matches:l,metadata:{}}}}(b||(b={})),function(e){e.invoke="completer:invoke",e.invokeNotebook="completer:invoke-notebook",e.select="completer:select",e.selectNotebook="completer:select-notebook"}(y||(y={}));const f={id:"completer",autoStart:!0,requires:[m.ICompletionManager,a.INotebookTracker],activate:async(e,t,n)=>{console.log("JupyterLab extension jupysql-plugin is activated!"),n.widgetAdded.connect(((e,n)=>{var o,i;let l=null!==(i=null===(o=n.content.activeCell)||void 0===o?void 0:o.editor)&&void 0!==i?i:null;const a=n.sessionContext.session,s=n.sessionContext,r={session:a,editor:l,sessionContext:s},c=new v([]),d=t.register({connector:c,editor:l,parent:n}),u=()=>{var e,t;l=null!==(t=null===(e=n.content.activeCell)||void 0===e?void 0:e.editor)&&void 0!==t?t:null,r.session=n.sessionContext.session,r.sessionContext=n.sessionContext,r.editor=l,d.editor=l;const o=new m.KernelConnector(r),i=new m.ContextConnector(r),a=new g(r);d.connector=new v([o,i,a])};n.content.activeCellChanged.connect(u),n.sessionContext.sessionChanged.connect(u)})),e.commands.addCommand(y.invokeNotebook,{execute:()=>{var t;const o=n.currentWidget;if(o&&"code"===(null===(t=o.content.activeCell)||void 0===t?void 0:t.model.type))return e.commands.execute(y.invoke,{id:o.id})}}),e.commands.addCommand(y.selectNotebook,{execute:()=>{const t=n.currentWidget&&n.currentWidget.id;if(t)return e.commands.execute(y.select,{id:t})}}),e.commands.addKeyBinding({command:y.selectNotebook,keys:["Enter"],selector:".jp-Notebook .jp-mod-completer-active"})}};var C=n(5923),w=n(6303),E=n(6560);class _{constructor(e){this.notebookTracker=e}async formatAllCodeCells(e,t,n){return this.formatCells(!1,e,t,n)}getCodeCells(e=!0,t){if(!this.notebookTracker.currentWidget)return[];const n=[];return(t=t||this.notebookTracker.currentWidget.content).widgets.forEach((o=>{"code"===o.model.type&&(e&&!t.isSelectedOrActive(o)||n.push(o))})),n}async formatCells(e,t,n,o){if(!this.working){try{this.working=!0;const t=this.getCodeCells(e,o);if(0===t.length)return void(this.working=!1);for(let e=0;e<t.length;++e){const n=t[e],o=n.model.value.text;if(o.startsWith("%%sql")){const e=o.split("\n"),t=e.shift();try{const o=(0,E.format)(e.join("\n"),{language:"sql",keywordCase:"upper"});n.model.value.text=t+"\n"+o}catch(e){}}}}catch(e){await(0,w.showErrorMessage)("Jupysql plugin formatting",e)}this.working=!1}}applicable(e,t){const n=this.notebookTracker.currentWidget;return n&&t===n}}var k=n(6271),x=n.n(k),T=n(6319),N=n(9418);var S=n(344),j=n(5139);async function O(e="",t={}){const n=j.ServerConnection.makeSettings(),o=S.URLExt.join(n.baseUrl,"dashboard",e);let i;try{i=await j.ServerConnection.makeRequest(o,t,n)}catch(e){throw new j.ServerConnection.NetworkError(e)}let l=await i.text();if(l.length>0)try{l=JSON.parse(l)}catch(e){console.log("Not a JSON response body.",i)}if(!i.ok)throw new j.ServerConnection.ResponseError(i,l.message||l);return l}const M=e=>{var t,n,o,i,l,a;return"missing file"==(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.type)?x().createElement("div",{"data-testid":"error-message-area"},x().createElement(T.Typography,{variant:"subtitle1",gutterBottom:!0}," A ",x().createElement("code",null,null===(o=null===(n=null==e?void 0:e.message)||void 0===n?void 0:n.detail)||void 0===o?void 0:o.fileName)," file with dependencies is required to deploy your notebook. Please add it at ",x().createElement("code",null,null===(l=null===(i=null==e?void 0:e.message)||void 0===i?void 0:i.detail)||void 0===l?void 0:l.filePath),". To learn more, see the ",x().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.cloud.ploomber.io/en/latest/dashboards/jupyterlab-plugin.html#create-sample-notebook-and-requirements-txt"},"docs"))):x().createElement(T.Typography,{variant:"subtitle1",gutterBottom:!0},null===(a=null==e?void 0:e.message)||void 0===a?void 0:a.detail)},A=e=>{var t,n;const o=e.notebook_path,[i]=(0,k.useState)((null===(n=null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.get("ploomber"))||void 0===n?void 0:n.project_id)||""),[l,a]=(0,k.useState)(!0),[s,r]=(0,k.useState)(!1),[c,d]=(0,k.useState)(!1),[u,m]=(0,k.useState)(!1),[p,v]=(0,k.useState)(""),[h,g]=(0,k.useState)(""),[b,y]=(0,k.useState)("init"),[f,C]=(0,k.useState)(null),[w,E]=(0,k.useState)("");(0,k.useEffect)((()=>{_()}),[]),(0,k.useEffect)((()=>{"success"===b&&(i?(m(!1),S()):m(!0))}),[b]);const _=async()=>{await O("apikey").then((e=>{null!=(null==e?void 0:e.data)&&(v(e.data),y("success"))})).catch((e=>{console.error(`The jupyterlab_examples_server server extension appears to be missing.\n${e}`)})),a(!1)},S=async()=>{r(!0);const t={notebook_path:o,api_key:p,project_id:i};await O("job",{body:JSON.stringify(t),method:"POST"}).then((t=>{var n,o,i=t.deployment_result,l={type:"generic",detail:""};"missing file"===(null==i?void 0:i.type)&&(null==i?void 0:i.detail)?(l.type=i.type,l.detail={fileName:"requirements.txt",filePath:i.detail},C(l)):(null==i?void 0:i.detail)||(null==i?void 0:i.message)?(l.detail=i.detail||i.message,C(l)):(g("https://platform.ploomber.io/dashboards/"+(null==i?void 0:i.project_id)+"/"+(null==i?void 0:i.id)),null===(n=null==e?void 0:e.metadata)||void 0===n||n.set("ploomber",{project_id:null==i?void 0:i.project_id}),null===(o=null==e?void 0:e.context)||void 0===o||o.save())})),r(!1)},j={init:{label:"API Key",variant:"outlined",color:"primary"},success:{label:"Valid API Key",variant:"filled",color:"success"},error:{label:"Please enter valid API Key",variant:"filled",color:"warning"}};return x().createElement(T.Box,{p:6,style:{width:600}},l||s?x().createElement(T.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center"}},x().createElement(T.CircularProgress,null)):x().createElement(x().Fragment,null,x().createElement(T.Grid,{container:!0,spacing:4,alignItems:"center",direction:"column"},"success"!==b&&x().createElement("div",null,x().createElement(T.Grid,{item:!0,container:!0,direction:"row",alignItems:"center",width:"100%"},x().createElement(T.Grid,{container:!0,direction:"row",alignItems:"center",spacing:1},x().createElement(T.Grid,{item:!0,xs:10},x().createElement(T.TextField,{id:"api-key-input",size:"small",onChange:e=>{v(e.target.value)},value:p,label:j[b].label,variant:j[b].variant,color:j[b].color,error:"error"==b,fullWidth:!0,focused:!0})),x().createElement(T.Grid,{item:!0,xs:2,alignItems:"center",justifyContent:"center"},x().createElement(T.Button,{onClick:async()=>{a(!0);const e={api_key:p};await O("apikey",{body:JSON.stringify(e),method:"POST"}).then((e=>{"success"==(null==e?void 0:e.result)?y("success"):y("error")})).catch((t=>{console.error(`Error on POST ${e}.\n${t}`)})),a(!1)},variant:"contained",size:"small"},"CONFIRM")))),x().createElement(T.Grid,{item:!0,container:!0,direction:"row",alignItems:"center",width:"100%"},x().createElement(T.Link,{href:"https://www.platform.ploomber.io/register/",target:"_blank",rel:"noopener noreferrer"},"Click here to get an API Key"))),"success"==b&&x().createElement(T.Grid,{item:!0,container:!0,alignItems:"center",spacing:4,direction:"column"},u?x().createElement(x().Fragment,null,x().createElement(x().Fragment,null,x().createElement(T.Typography,{variant:"subtitle1",gutterBottom:!0},"Clicking on deploy will upload your notebook to Ploomber Cloud servers"),x().createElement(T.Button,{onClick:async()=>{m(!1),await S()},variant:"contained",size:"small",color:"primary",disabled:""!==h,endIcon:x().createElement(N.Z,null)},"CONFIRM "))):x().createElement(x().Fragment,null,f?x().createElement(M,{message:f}):x().createElement(x().Fragment,null,x().createElement(T.Grid,{item:!0,justifyContent:"center",xs:12},"Check your deployment status here:"),x().createElement(T.Grid,{item:!0,justifyContent:"center",xs:12},x().createElement(T.Chip,{label:h,variant:"outlined",onClick:()=>{window.open(h),d(!0),E("Deployment Success")}}),x().createElement(T.Snackbar,{open:c,onClose:()=>d(!1),autoHideDuration:2e3,message:w}))))))))};class D extends w.ReactWidget{constructor(e){super(),this.state={notebookPath:e.notebookPath,metadata:e.metadata,context:e.context}}render(){return x().createElement(A,{notebook_path:this.state.notebookPath,metadata:this.state.metadata,context:this.state.context})}}class L{constructor(){}createNew(e,t){const n=new w.ToolbarButton({className:"deploy-nb-button",label:"Deploy Notebook",onClick:()=>{!function(e,t){const n=new D({notebookPath:e.context.contentsModel.path,metadata:e.model.metadata,context:t});new w.Dialog({title:"Deploy Notebook",body:n,buttons:[{label:"Close",caption:"",className:"bg-info",accept:!1,actions:[],displayType:"default",iconClass:"",iconLabel:""}]}).launch()}(e,t)},tooltip:"Deploy Notebook as dashboards"});return n.node.setAttribute("data-testid","deploy-btn"),e.toolbar.insertItem(10,"deployNB",n),new C.DisposableDelegate((()=>{n.dispose()}))}}class I{createNew(e,t){return setTimeout((()=>{(e=>{var t;const n=null===(t=e.sessionContext.session)||void 0===t?void 0:t.kernel;n&&document.addEventListener("onUpdateTableWidget",(async e=>{const t=e.detail.data,o=n.createComm("comm_target_handle_table_widget");await o.open("initializing connection").done,o.send(t),o.onMsg=e=>{const t=e.content.data;let n=new CustomEvent("onTableWidgetRowsReady",{bubbles:!0,cancelable:!0,composed:!1,detail:{data:t}});document.body.dispatchEvent(n)}}))})(t)}),5e3),new C.DisposableDelegate((()=>{}))}}class R{constructor(e){this.notebookCodeFormatter=new _(e)}createNew(e,t){const n=new w.ToolbarButton({className:"format-sql-button",label:"Format SQL",onClick:()=>{this.notebookCodeFormatter.formatAllCodeCells(void 0,void 0,e.content)},tooltip:"Format all %%sql cells"});return n.node.setAttribute("data-testid","format-btn"),e.toolbar.insertItem(10,"formatSQL",n),new C.DisposableDelegate((()=>{n.dispose()}))}}const q={activate:(e,t)=>{e.docRegistry.addWidgetExtension("Notebook",new R(t)),e.docRegistry.addWidgetExtension("Notebook",new L),e.docRegistry.addWidgetExtension("Notebook",new I)},autoStart:!0,id:"formatting",requires:[a.INotebookTracker]};var P=n(2673);const F=n(4147),B=F.version,U=F.name;var H=n(3379),W=n.n(H),V=n(7517);W()(V.Z,{insert:"head",singleton:!1}),V.Z.locals;class J extends P.DOMWidgetModel{defaults(){return{...super.defaults(),_model_name:J.model_name,_model_module:J.model_module,_model_module_version:J.model_module_version,_view_name:J.view_name,_view_module:J.view_module,_view_module_version:J.view_module_version,value:"Hello World"}}}J.serializers={...P.DOMWidgetModel.serializers},J.model_name="FormModel",J.model_module=U,J.model_module_version=B,J.view_name="FormView",J.view_module=U,J.view_module_version=B;class z extends P.DOMWidgetView{render(){this.el.classList.add("custom-widget"),this.el.innerHTML='\n        <form id="myForm">\n        <label for="protocol">Select a protocol:</label>\n        <select id="protocol" name="protocol">\n          <option value="HTTP">HTTP</option>\n          <option value="HTTPS">HTTPS</option>\n        </select>\n      \n        <label for="port">Enter a port:</label>\n        <input type="number" id="port" name="port">\n\n        <div id="confirmationMessage"></div>\n      \n        <button type="submit">Submit</button>\n      </form>\n      \n',this.el.querySelector("#myForm").addEventListener("submit",this.handleFormSubmit.bind(this)),this.model.on("msg:custom",this.handleMessage.bind(this))}handleFormSubmit(e){e.preventDefault();const t=e.target,n=new FormData(t),o={};for(const[e,t]of n.entries())o[e]=t.toString();this.sendFormData(o)}sendFormData(e){const t={method:"submit_form",data:e};this.send(t)}handleMessage(e){if("display_confirmation_message"===e.method){const t=this.el.querySelector("#confirmationMessage");t&&(t.textContent=e.message)}}}n(4039);var $=n(9982);class G extends P.DOMWidgetModel{defaults(){return{...super.defaults(),_model_name:G.model_name,_model_module:G.model_module,_model_module_version:G.model_module_version,_view_name:G.view_name,_view_module:G.view_module,_view_module_version:G.view_module_version,value:"Hello World"}}}G.serializers={...P.DOMWidgetModel.serializers},G.model_name="TableModel",G.model_module=U,G.model_module_version=B,G.view_name="TableView",G.view_module=U,G.view_module_version=B;class K extends P.DOMWidgetView{render(){const e=[{symbol:"AAPL",price:142.34,change:1.25},{symbol:"GOOGL",price:2725.45,change:-4.56},{symbol:"MSFT",price:259.43,change:2.78},{symbol:"AMZN",price:3310.98,change:-7.92}];this.el.innerHTML=`\n      <table class="table">\n        <thead>\n          <tr>\n            <th data-bs-toggle="tooltip" data-bs-placement="top" title="symbol">Symbol</th>\n            <th data-bs-toggle="tooltip" data-bs-placement="top" title="price">Price</th>\n            <th data-bs-toggle="tooltip" data-bs-placement="top" title="change">Change</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${e.map((e=>`\n            <tr>\n              <td>${e.symbol}</td>\n              <td>${e.price}</td>\n              <td>${e.change}</td>\n            </tr>\n          `)).join("")}\n        </tbody>\n      </table>\n    `,Array.from(this.el.querySelectorAll('[data-bs-toggle="tooltip"]')).forEach((t=>{const n=t.getAttribute("title"),o=e.map((e=>e[n])).join(", ");new $.Tooltip(t,{title:o})}))}}var Z=n(9889);W()(Z.Z,{insert:"head",singleton:!1}),Z.Z.locals;class Y extends P.DOMWidgetModel{defaults(){return{...super.defaults(),_model_name:Y.model_name,_model_module:Y.model_module,_model_module_version:Y.model_module_version,_view_name:Y.view_name,_view_module:Y.view_module,_view_module_version:Y.view_module_version,connections:Y.connections,connections_templates:Y.connections_templates}}}Y.serializers={...P.DOMWidgetModel.serializers},Y.model_name="ConnectorModel",Y.model_module=U,Y.model_module_version=B,Y.view_name="ConnectorModel",Y.view_module=U,Y.view_module_version=B,Y.connections=[],Y.connections_templates=[];class Q extends P.DOMWidgetView{constructor(){super(...arguments),this.connections=JSON.parse(this.model.get("connections")),this.connectionsTemplates=JSON.parse(this.model.get("connections_templates")),this.activeConnection=""}render(){this.el.classList.add("connector-widget"),this.drawConnectorUI(this.connections),this.model.on("msg:custom",this.handleMessage.bind(this))}drawConnectorUI(e){this.el.innerHTML="",this.el.innerHTML='\n        <div id="connectionsManager">\n            <div id="connectionsContainer" class="block">\n                <h3>\n                    Connections\n                </h3>\n\n                <div class="connections-guidelines block">\n                    <i>\n                        * Connections are loaded from your connections file (set it with <code>%config SqlMagic.dsn_filename = "path/to/file", default is "~/.jupysql/connections.ini"</code>).\n                    </i>\n\n                    <i class="no-config-file" style = "display: none;">\n                        * No connections file found. You may need to restart the kernel.\n                    </i>\n\n                    <i class="restart-kernel" style = "display: none;">\n                        * No connections found in connections file. You may need to restart the kernel.\n                    </i>                    \n                </div>\n\n                <div id="connectionsButtonsContainer" class="block">\n                </div>\n\n                <div class="block">\n                    <div class="create-new-connection" id="createNewConnectionButton">\n                        <div class="icon"></div>\n                        <div>\n                            Create new connection\n                        </div>\n                    </div>\n                </div>\n         \n            </div>\n\n            <div class="user-error-message lm-Widget p-Widget lm-Panel p-Panel jp-OutputArea-child" style = "display: none">\n            <div class="lm-Widget jp-RenderedText" data-mime-type="application/vnd.jupyter.stderr">\n            <pre></pre>\n            </div>\n            </div>\n\n\n            <div id="newConnectionContainer" class="block" style = "display: none">\n                <h3>Create new connection</h3>\n                <div class="block">\n                    <select id="selectConnection"></select>\n\n                    <div id="connectionFormContainer">\n                    </div>\n                </div>\n            </div>\n        </div>\n        ',e.forEach((e=>{const{name:t}=e,n=t.replace(/ /g,"_"),o=document.createElement("DIV");o.className="connection-button-container";const i=document.createElement("DIV");i.className="connection-button-actions";const l=document.createElement("DIV");l.className="connection-name",l.innerText=t,i.appendChild(l);const a=document.createElement("BUTTON");a.id=`connBtn_${n}`,a.className="secondary",a.innerHTML="Connect",a.onclick=this.handleConnectionClick.bind(this,e);const s=document.createElement("BUTTON");s.className="delete-connection-button",s.id=`deleteConnBtn_${n}`,s.onclick=this.handleDeleteConnectionClick.bind(this,e);let r=this.el.querySelector("#connectionsButtonsContainer");i.appendChild(a),i.appendChild(s),o.appendChild(i),r.appendChild(o);let c=document.createElement("HR");c.className="divider",o.appendChild(c)}));const t=this.el.querySelector("#selectConnection");Object.keys(this.connectionsTemplates).forEach((e=>{const n=document.createElement("OPTION");n.innerHTML=e,t.appendChild(n)})),t.addEventListener("change",this.handleCreateNewConnectionChange.bind(this)),this.el.querySelector("#createNewConnectionButton").addEventListener("click",this.handleCreateNewConnectionClick.bind(this)),this.activeConnection&&this.markConnectedButton(this.activeConnection),setTimeout((()=>{this.send({method:"check_config_file"})}),500)}handleConnectionClick(e){const t={method:"connect",data:e};this.send(t)}deleteConnection(e){const t={method:"delete_connection",data:e};this.send(t)}handleDeleteConnectionClick(e){this.hideDeleteMessageApproval();const t=document.createElement("DIV");t.id="deleteConnectionMessage";const n=`<h4>Delete ${e.name} from ini file</h4>\n        <div>Please note that by doing so, you will permanently remove <strong>${e.name}</strong> from the ini file.<div>\n        <div>Are you sure?</div>\n        `;t.innerHTML=`${n} <div class='actions' style = 'margin-top: 20px; display: inline-flex'></div>`;const o=document.createElement("BUTTON");o.innerHTML="Cancel",o.addEventListener("click",this.hideDeleteMessageApproval.bind(this)),t.querySelector(".actions").appendChild(o);const i=document.createElement("BUTTON");i.innerHTML="Delete",i.className="danger",i.addEventListener("click",this.deleteConnection.bind(this,e)),t.querySelector(".actions").appendChild(i);const l=this.el.querySelector(`#deleteConnBtn_${e.name.replace(/ /g,"_")}`).parentNode;l.style.display="none",l.parentNode.prepend(t)}hideDeleteMessageApproval(){var e;null===(e=this.el.querySelector("#deleteConnectionMessage"))||void 0===e||e.remove(),this.el.querySelectorAll(".connection-button-actions").forEach((e=>e.style.display="inline-flex"))}handleCreateNewConnectionClick(){this.el.querySelector("#connectionsContainer").style.display="none",this.el.querySelector("#newConnectionContainer").style.display="block",this.handleCreateNewConnectionChange()}handleCreateNewConnectionChange(){const e=this.el.querySelector("#selectConnection").value,t=this.connectionsTemplates[e];this.drawNewConnectionForm(t)}drawNewConnectionForm(e){const{fields:t}=e,n=this.el.querySelector("#connectionFormContainer");n.innerHTML="";const o=document.createElement("FORM");o.id="connectionForm",n.appendChild(o),t.forEach((e=>{const t=document.createElement("DIV");t.className="field-container";const n=document.createElement("LABEL");n.setAttribute("for",e.id),n.innerHTML=e.label;const i=document.createElement("INPUT");i.id=e.id,i.name=e.id,i.className="field",void 0!==e.default&&(i.value=e.default),i.setAttribute("type",e.type),t.appendChild(n),t.appendChild(i),o.appendChild(t)}));const i=document.createElement("DIV");i.className="buttons-container";const l=document.createElement("BUTTON");l.innerHTML="Cancel",l.className="secondary",l.addEventListener("click",this.drawConnectorUI.bind(this,this.connections)),i.appendChild(l);const a=document.createElement("BUTTON");a.className="primary",a.innerHTML="Create",o.addEventListener("submit",this.handleSubmitNewConnection.bind(this)),i.appendChild(a),o.appendChild(i)}handleSubmitNewConnection(e){e.preventDefault();let t=!0;const n=e.target,o=new FormData(n),i={};for(const[e,n]of o.entries()){const o=n.toString();i[e]=o,0===o.length&&(t=!1)}const l=this.el.querySelector("#selectConnection"),a=this.connectionsTemplates[l.value].driver;i.driver=a,t?this.sendFormData(i):this.showErrorMessage("Error: Please fill in all fields.")}sendFormData(e){const t={method:"submit_new_connection",data:e};this.send(t)}handleMessage(e){if("update_connections"===e.method&&(this.connections=JSON.parse(e.message),this.drawConnectorUI(this.connections)),"connected"===e.method){const t=e.message;this.activeConnection=t,this.markConnectedButton(t)}if("connection_name_exists_error"===e.method){const t=`A connection named ${e.message} already exists in your connections file`;this.showErrorMessage(t)}if("connection_error"===e.method){const t=e.message;this.showErrorMessage(t)}if("check_config_file"===e.method){const t=e.message,n=this.el.querySelector(".connections-guidelines .no-config-file");t?(n.style.display="none",this.el.querySelector(".connections-guidelines .no-config-file").style.display=0===this.connections.length?"block":"none"):n.style.display="block"}}markConnectedButton(e){this.el.querySelectorAll(".connection-button-actions button:not(.delete-connection-button)").forEach((e=>{const t=e;t.innerHTML="Connect",t.classList.remove("primary"),t.classList.add("secondary")}));const t=this.el.querySelector(`#connBtn_${e.replace(/ /g,"_")}`);t.innerText="Connected",t.classList.add("primary")}showErrorMessage(e){const t=this.el.querySelector(".user-error-message");t.querySelector("pre").innerHTML=`${e}`,t.style.display="block"}}const X={...o,...i,...l},ee=[f,d,q,{id:"jupysql-plugin:plugin",requires:[P.IJupyterWidgetRegistry],activate:function(e,t){t.registerWidget({name:U,version:B,exports:X})},autoStart:!0}]},9889:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var o=n(3645),i=n.n(o),l=n(1667),a=n.n(l),s=n(9941),r=n.n(s),c=n(3162),d=n.n(c),u=i()((function(e){return e[1]})),m=a()(r()),p=a()(d());u.push([e.id,":root {\n    --danger: #f53649;\n    --white: #ffffff;\n    --margin: 10px;\n    --primary: #206eef;\n  }\n\n.connector-widget .connection-button-container .connection-button-actions {\n    display: inline-flex;\n    width: 100%;\n}\n\n.connector-widget #connectionsButtonsContainer {\n    display: grid;\n}\n\n.connector-widget .connection-button-container .delete-connection-button {\n    margin-left: 10px;\n    background-repeat: no-repeat;\n    background-size: 24px;\n    background-position: center;\n    background-image: url("+m+");\n    background-color: transparent;\n    border: none;\n    width: 24px;\n}\n\n.create-new-connection {\n    display: inline-flex;\n    color: var(--primary)\n}\n\n.create-new-connection:hover {\n    cursor: pointer;\n}\n\n.create-new-connection .icon{\n    background-image: url("+p+");\n    min-width: 30px;\n    height: 30px;\n    background-repeat: no-repeat;\n    background-size: 15px;\n    background-position: center;\n    background-color: transparent;\n    margin: 0;    \n}\n\n.create-new-connection div {\n    margin: auto var(--margin);\n    margin-top: 2px;\n}\n\n.create-new-connection div:nth-child(2) {\n    margin-left: 2px;\n}\n\n.connector-widget .connection-button-container {\n    margin: var(--margin) 0;\n}\n\n.connector-widget hr.divider {\n    margin: 0;\n    margin-top:20px;\n}\n\n.connector-widget button {\n    width: fit-content;\n    border: none;\n    padding: 5px 10px;\n    border: 1px solid transparent;\n    border-radius: 5px;\n}\n\n.connector-widget button.secondary {\n    background-color: transparent;\n    border: 1px solid var(--primary);\n    color: var(--primary);\n}\n\n.connector-widget button.primary {\n    background-color: var(--primary);\n    color: #fff;\n    border: 1px solid var(--primary);\n}\n\n.connector-widget .connection-button-actions .connection-name {\n    margin: auto 30px;\n    margin-left: 0;\n    width: 100%;\n    font-weight: 500;\n}\n\nbutton.danger {\n    background-color: var(--danger);\n    color: var(--white);\n    margin-left: var(--margin);\n}\n\nform#connectionForm .field-container {\n    display: inline-flex;\n    width: 100%;\n    margin: var(--margin) 0;\n}\n\nform#connectionForm label {\n    width: 50%;\n    margin: auto 0;\n}\n\nform#connectionForm .field {\n    width: -webkit-fill-available;\n    margin-left: var(--margin);\n    padding: 5px 10px;\n}\n\nform#connectionForm input:not(input[type='submit']) {\n    /* margin: 10px;\n    padding: 5px 10px; */\n}\n\n#selectConnection {\n    width: 100%;\n    padding: 6px 10px;\n    margin-bottom: var(--margin);\n}\n\n.warning-message {\n    margin-bottom: var(--margin);\n}\n\n.block {\n    margin: 30px 0px;\n    /* border: 1px solid #000; */\n    width: 600px;\n}\n\nform#connectionForm .buttons-container {\n    text-align: right;\n    margin: var(--margin) 0;\n}\n\nform#connectionForm .buttons-container button:first-child {\n    margin-right: var(--margin);\n}",""]);const v=u},7517:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(3645),i=n.n(o)()((function(e){return e[1]}));i.push([e.id,".custom-widget {\n    background-color: lightseagreen;\n    padding: 0px 2px;\n}",""]);const l=i},3162:e=>{e.exports="data:image/svg+xml,%3Csvg width='14' height='14' viewBox='0 0 14 14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='M14 8H8V14H6V8H0V6H6V0H8V6H14V8Z' fill='%23206EEF'/%3E %3C/svg%3E"},9941:e=>{e.exports="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24px' viewBox='0 0 24 24' width='24px' fill='%23000000'%3E%3Cpath d='M0 0h24v24H0V0z' fill='none'/%3E%3Cpath d='M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4z'/%3E%3C/svg%3E"},4147:e=>{"use strict";e.exports=JSON.parse('{"name":"jupysql-plugin","version":"0.2.0","description":"Jupyterlab extension for JupySQL","private":true,"keywords":["jupyter","jupyterlab","jupyterlab-extension"],"homepage":"https://github.com/ploomber/jupysql-plugin.git","bugs":{"url":"https://github.com/ploomber/jupysql-plugin.git/issues"},"license":"BSD-3-Clause","author":{"name":"Ploomber","email":"contact@ploomber.io"},"files":["lib/**/*.{d.ts,eot,gif,html,jpg,js,js.map,json,png,svg,woff2,ttf}","style/**/*.{css,js,eot,gif,html,jpg,json,png,svg,woff2,ttf}"],"main":"lib/index.js","types":"lib/index.d.ts","style":"style/index.css","repository":{"type":"git","url":"https://github.com/ploomber/jupysql-plugin.git.git"},"workspaces":{"packages":["jupysql_plugin","ui-tests"]},"scripts":{"build":"jlpm build:lib && jlpm build:labextension:dev","build:prod":"jlpm clean && jlpm build:lib:prod && jlpm build:labextension","build:labextension":"jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True .","build:lib":"tsc --sourceMap","build:lib:prod":"tsc","clean":"jlpm clean:lib","clean:lib":"rimraf lib tsconfig.tsbuildinfo","clean:lintcache":"rimraf .eslintcache .stylelintcache","clean:labextension":"rimraf jupysql_plugin/labextension jupysql_plugin/_version.py","clean:all":"jlpm clean:lib && jlpm clean:labextension && jlpm clean:lintcache","eslint":"jlpm eslint:check --fix","eslint:check":"eslint . --cache --ext .ts,.tsx","install:extension":"jlpm build","lint":"jlpm stylelint && jlpm prettier && jlpm eslint","lint:check":"jlpm stylelint:check && jlpm prettier:check && jlpm eslint:check","prettier":"jlpm prettier:base --write --list-different","prettier:base":"prettier \\"**/*{.ts,.tsx,.js,.jsx,.css,.json,.md}\\"","prettier:check":"jlpm prettier:base --check","stylelint":"jlpm stylelint:check --fix","stylelint:check":"stylelint --cache \\"style/**/*.css\\"","test":"jest --coverage","watch":"run-p watch:src watch:labextension","watch:src":"tsc -w","watch:labextension":"jupyter labextension watch ."},"@comment":{"dependencies":{"@lumino/widgets":"An official library to implement the frontend of the widgets: https://github.com/jupyterlab/lumino"}},"dependencies":{"@emotion/react":"^11.11.0","@emotion/styled":"^11.11.0","@jupyter-widgets/base":"^6.0.4","@jupyterlab/application":"^3.6.2","@jupyterlab/codeeditor":"^3.6.2","@jupyterlab/codemirror":"^3.6.3","@jupyterlab/completer":"^3.6.2","@jupyterlab/notebook":"^3.6.2","@jupyterlab/statedb":"^3.6.2","@lumino/widgets":"<2.0.0","@mui/icons-material":"^5.11.16","@mui/material":"^5.13.4","@types/codemirror":"^5.60.7","@types/underscore":"^1.11.4","bootstrap":"^5.2.3","clean":"^4.0.2","react":"^17.0.2","sql-formatter":"^12.2.0","underscore":"^1.13.6"},"devDependencies":{"@babel/core":"^7.0.0","@babel/preset-env":"^7.0.0","@jupyterlab/builder":"^3.1.0","@jupyterlab/testutils":"^3.0.0","@testing-library/jest-dom":"^5.16.5","@testing-library/react":"^12.1.2","@types/bootstrap":"^5.2.6","@types/jest":"^26.0.0","@types/jest-when":"^3.5.2","@typescript-eslint/eslint-plugin":"^4.8.1","@typescript-eslint/parser":"^4.8.1","eslint":"^7.14.0","eslint-config-prettier":"^6.15.0","eslint-plugin-prettier":"^3.1.4","jest":"^26.0.0","jest-when":"^3.5.2","npm-run-all":"^4.1.5","prettier":"^2.1.1","react-dom":"^17.0.2","rimraf":"^3.0.2","stylelint":"^14.3.0","stylelint-config-prettier":"^9.0.4","stylelint-config-recommended":"^6.0.0","stylelint-config-standard":"~24.0.0","stylelint-prettier":"^2.0.0","ts-jest":"^26.0.0","typescript":"^4.1.3"},"sideEffects":["style/*.css","style/index.js"],"styleModule":"style/index.js","publishConfig":{"access":"public"},"jupyterlab":{"extension":true,"outputDir":"jupysql_plugin/labextension","sharedPackages":{"@jupyter-widgets/base":{"bundled":false,"singleton":true}}}}')}}]);