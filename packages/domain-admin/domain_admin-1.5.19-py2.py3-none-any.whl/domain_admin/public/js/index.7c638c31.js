import{_ as _t}from"./index.553043ac.js";import{ah as W,o as nt,c as pt,V as F,P as j,a as lt,T as bt,U as dt,F as Tt,a8 as Pt,O as gt,S as Dt,ar as Xt,a9 as Jt,Q as Qt}from"./vendor-vue.9e61e0af.js";import{F as xt,c as Ht}from"./vendor-lib.6ffc91e0.js";import{H as Rt}from"./highlight-lib.3654f6d3.js";import{C as Ut}from"./ConnectStatus.0cbf832d.js";import{h as te}from"./highlight-util.a4f1867f.js";import{c as Ft}from"./element-plus.1c4dcd05.js";import{E as ee}from"./ExpireProgress.d6ba5dd7.js";import{D as re}from"./DataCount.b0ecac5c.js";import"./element-icon.1ce1c350.js";const ie={domains:[{message:"\u57DF\u540D\u5217\u8868\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],status:[{message:"\u9A8C\u8BC1\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],start_time:[{message:"SSL\u7B7E\u53D1\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],expire_time:[{message:"SSL\u8FC7\u671F\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],create_time_label:[{message:"\u521B\u5EFA\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}]},ne={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{rules:ie,form:{domains:"",status:"",start_time:"",expire_time:"",create_time_label:""}}},computed:{},methods:{async getData(){if(this.row){let b={id:this.row.id};const k=await this.$http.function(b);if(k.code!=0)return;let n=k.data;this.form.domains=n.domains,this.form.status=n.status,this.form.start_time=n.start_time,this.form.expire_time=n.expire_time,this.form.create_time_label=n.create_time_label}},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(b=>{if(b)this.confirmSubmit();else return!1})},async confirmSubmit(){let b=this.$loading({fullscreen:!0}),k=this.form.domains.split(`
`);if(k=k.map(l=>l.trim()).filter(l=>l),k.length==0){this.$msg.error("\u8BF7\u8F93\u5165\u57DF\u540D");return}let n={domains:k};this.row&&(n.id=this.row.id);const A=await this.$http.issueCertificate(n);A.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success",A.data)):this.$msg.error(A.msg),this.$nextTick(()=>{b.close()})}},created(){this.getData()}},se={class:"text-center"};function ae(b,k,n,A,l,i){const a=W("el-input"),r=W("el-form-item"),d=W("el-form"),p=W("el-button");return nt(),pt("div",null,[F(d,{ref:"form",model:l.form,rules:l.rules,"label-width":"110px"},{default:j(()=>[F(r,{label:"id",prop:"id",style:{display:"none"}},{default:j(()=>[F(a,{type:"text",modelValue:l.form.id,"onUpdate:modelValue":k[0]||(k[0]=v=>l.form.id=v),placeholder:"id"},null,8,["modelValue"])]),_:1}),F(r,{label:b.$t("\u57DF\u540D\u5217\u8868"),prop:"domains"},{default:j(()=>[F(a,{type:"textarea",modelValue:l.form.domains,"onUpdate:modelValue":k[1]||(k[1]=v=>l.form.domains=v),rows:5,placeholder:b.$t("\u8BF7\u8F93\u5165\u57DF\u540D\u5217\u8868\uFF0C\u6BCF\u884C\u4E00\u4E2A")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"]),lt("div",se,[F(p,{onClick:i.handleCancel},{default:j(()=>[bt(dt(b.$t("\u53D6\u6D88")),1)]),_:1},8,["onClick"]),F(p,{type:"primary",onClick:i.handleSubmit},{default:j(()=>[bt(dt(b.$t("\u786E\u5B9A")),1)]),_:1},8,["onClick"])])])}const Wt=_t(ne,[["render",ae]]),oe={name:"",components:{ConnectStatus:Ut},props:{list:{type:Array}},emits:["on-success"],computed:{},data(){return{currentRow:null,dialogVisible:!1}},methods:{handleEditRow(b){this.currentRow=b,this.dialogVisible=!0},async handleDeleteClick(b){let k={id:b.id};const n=await this.$http.function(k);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg)},async handleStatusChange(b){let k={id:b.id};const n=await this.$http.function(k);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg)},handleUpdateSuccess(){this.$emit("on-success")},downloadVerifyFile(b){let k=new Blob([b.validation],{type:"application/octet-stream;charset=utf-8"});xt.saveAs(k,b.token)},handleCopyClick(b){Ht(b),this.$msg.success("\u5DF2\u590D\u5236\u5230\u526A\u5207\u677F")},async handleVerifyDomainById(b){let k=this.$loading({fullscreen:!0}),n={domain_verify_id:b.id};const A=await this.$http.verifyCertificateById(n);A.code==0?(this.$msg.success("\u9A8C\u8BC1\u6210\u529F"),this.$emit("on-success",A.data)):this.$msg.error(A.msg),this.$nextTick(()=>{k.close()})}},created(){}},le={style:{"margin-left":"4px"}},de=["onClick"],ue=["onClick"];function ce(b,k,n,A,l,i){const a=W("el-table-column"),r=W("ConnectStatus"),d=W("el-table");return nt(),pt("div",null,[F(d,{data:n.list,stripe:"",border:""},{default:j(()=>[F(a,{label:b.$t("\u57DF\u540D"),"header-align":"center",align:"center",prop:"domain",width:"230"},{default:j(p=>[lt("span",null,dt(p.row.domain),1)]),_:1},8,["label"]),F(a,{label:b.$t("\u9A8C\u8BC1\u72B6\u6001"),"header-align":"center",align:"center",prop:"status",width:"100"},{default:j(p=>[F(r,{value:p.row.status_value},null,8,["value"]),lt("span",le,dt(p.row.status||"-"),1)]),_:1},8,["label"]),F(a,{label:b.$t("TXT\u8BB0\u5F55"),"header-align":"center",align:"center",prop:"token"},{default:j(p=>[lt("div",{onClick:v=>i.handleCopyClick(p.row.token)},[lt("span",null,"_acme-challenge."+dt(p.row.domain),1)],8,de)]),_:1},8,["label"]),F(a,{label:b.$t("\u8BB0\u5F55\u503C"),"header-align":"center",align:"center",prop:"token"},{default:j(p=>[lt("div",{onClick:v=>i.handleCopyClick(p.row.validation)},dt(p.row.validation||"-"),9,ue)]),_:1},8,["label"])]),_:1},8,["data"])])}const he=_t(oe,[["render",ce]]);const fe={name:"VerifyStep",props:{form:{type:Object},list:{type:Array}},emits:["on-success"],components:{VerifyStepDNSDataTable:he},data(){return{}},computed:{domain_list(){return this.form.domains.join(" ")},nginxConfig(){return`server {
  listen 80;
  server_name ${this.domain_list};

  location /.well-known/acme-challenge/ {
      alias /var/www/challenges/;
      try_files $uri =404;
  }
}`}},methods:{async getData(){},async handleSubmit(){let b=this.$loading({fullscreen:!0}),k={issue_certificate_id:this.form.id,challenge_type:"dns-01"};const n=await this.$http.verifyCertificateById(k);n.code==0?(this.$msg.success("\u9A8C\u8BC1\u6210\u529F"),this.$emit("on-success",n.data)):this.$msg.error(n.msg),this.$nextTick(()=>{b.close()})},downloadVerifyFile(){let b=new Blob([this.form.validation],{type:"application/octet-stream;charset=utf-8"});xt.saveAs(b,this.form.token)}},mounted(){Rt.highlightAll()},created(){this.getData()}},pe={class:"mo-form-detail"},me={class:"text-center mt-md"};function _e(b,k,n,A,l,i){const a=W("VerifyStepDNSDataTable"),r=W("el-button");return nt(),pt("div",pe,[F(a,{form:n.form,list:n.list,"challenge-type":"dns-01"},null,8,["form","list"]),lt("div",me,[F(r,{type:"primary",onClick:i.handleSubmit},{default:j(()=>[bt("\u9A8C \u8BC1")]),_:1},8,["onClick"])])])}const ge=_t(fe,[["render",_e],["__scopeId","data-v-d9734d73"]]),ye={name:"",components:{ConnectStatus:Ut},props:{list:{type:Array}},emits:["on-success"],computed:{},data(){return{currentRow:null,dialogVisible:!1}},methods:{handleEditRow(b){this.currentRow=b,this.dialogVisible=!0},async handleDeleteClick(b){let k={id:b.id};const n=await this.$http.function(k);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg)},async handleStatusChange(b){let k={id:b.id};const n=await this.$http.function(k);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg)},handleUpdateSuccess(){this.$emit("on-success")},downloadVerifyFile(b){let k=new Blob([b.validation],{type:"application/octet-stream;charset=utf-8"});xt.saveAs(k,b.token)},handleCopyClick(b){Ht(b),this.$msg.success("\u5DF2\u590D\u5236\u5230\u526A\u5207\u677F")},async handleVerifyDomainById(b){let k=this.$loading({fullscreen:!0}),n={domain_verify_id:b.id};const A=await this.$http.verifyCertificateById(n);A.code==0?(this.$msg.success("\u9A8C\u8BC1\u6210\u529F"),this.$emit("on-success",A.data)):this.$msg.error(A.msg),this.$nextTick(()=>{k.close()})}},created(){}},be={style:{"margin-left":"4px"}},ve=["href"];function we(b,k,n,A,l,i){const a=W("el-table-column"),r=W("ConnectStatus"),d=W("Download"),p=W("el-icon"),v=W("el-link"),y=W("el-table");return nt(),pt("div",null,[F(y,{data:n.list,stripe:"",border:""},{default:j(()=>[F(a,{label:b.$t("\u57DF\u540D"),"header-align":"center",align:"center",prop:"domain",width:"230","show-overflow-tooltip":""},{default:j(_=>[lt("span",null,dt(_.row.domain||"-"),1)]),_:1},8,["label"]),F(a,{label:b.$t("\u9A8C\u8BC1\u72B6\u6001"),"header-align":"center",align:"center",prop:"status",width:"100"},{default:j(_=>[F(r,{value:_.row.status_value},null,8,["value"]),lt("span",be,dt(_.row.status||"-"),1)]),_:1},8,["label"]),F(a,{label:b.$t("\u9A8C\u8BC1URL"),"header-align":"center",align:"center",prop:"validation","show-overflow-tooltip":""},{default:j(_=>[lt("a",{href:_.row.verify_url,target:"_blank",class:"mo-link"},dt(_.row.verify_url),9,ve)]),_:1},8,["label"]),F(a,{label:b.$t("\u9A8C\u8BC1\u6587\u4EF6"),"header-align":"center",align:"center",prop:"validation",width:"110"},{default:j(_=>[F(v,{underline:!1,type:"primary",class:"mr-sm",onClick:o=>i.downloadVerifyFile(_.row)},{default:j(()=>[F(p,null,{default:j(()=>[F(d)]),_:1}),bt(dt(b.$t("\u4E0B\u8F7D")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])])}const ke=_t(ye,[["render",we]]),Se={host:[{message:"\u4E3B\u673A\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],user:[{message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],password:[{message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],private_key:[{message:"\u79D8\u94A5\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}]},$t={PASSWORD:1,PRIVATE_KEY:2},Ce=[{label:"\u5BC6\u7801",value:$t.PASSWORD},{label:"\u79C1\u94A5\u8BC1\u4E66",value:$t.PRIVATE_KEY}],xe={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{rules:Se,HostAuthTypeEnum:$t,HostAuthTypeOptions:Ce,form:{host:"",user:"",auth_type:$t.PASSWORD,password:"",private_key:""}}},computed:{},methods:{async getData(){if(console.log(this.row),this.row&&this.row.id){const b=await this.getHostById(this.row.id);for(let k in this.form)this.form[k]=b[k]}else this.row&&this.row.host&&(this.form.host=this.row.host)},async getHostById(b){let k={host_id:b};return(await this.$http.getHostById(k)).data},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(b=>{if(b)this.confirmSubmit();else return!1})},async confirmSubmit(){let b=this.$loading({fullscreen:!0}),k={host:this.form.host,user:this.form.user,password:this.form.password,private_key:this.form.private_key,auth_type:this.form.auth_type},n=null,A=null;if(this.row&&this.row.id?(A=this.row.id,k.host_id=this.row.id,n=await this.$http.updateHostById(k),{...this.row,...k}):(n=await this.$http.addHost(k),n.data,A=n.data.id),n.code==0){this.$msg.success("\u64CD\u4F5C\u6210\u529F");let l=await this.getHostById(A);this.$emit("on-success",l)}else this.$msg.error(n.msg);this.$nextTick(()=>{b.close()})}},created(){this.getData()}},De={class:"text-center"};function ze(b,k,n,A,l,i){const a=W("el-input"),r=W("el-form-item"),d=W("el-option"),p=W("el-select"),v=W("el-form"),y=W("el-button");return nt(),pt("div",null,[F(v,{ref:"form",model:l.form,rules:l.rules,"label-width":"100px"},{default:j(()=>[F(r,{label:"\u4E3B\u673A\u5730\u5740",prop:"host"},{default:j(()=>[F(a,{type:"text",modelValue:l.form.host,"onUpdate:modelValue":k[0]||(k[0]=_=>l.form.host=_),placeholder:"\u4E3B\u673A\u5730\u5740"},null,8,["modelValue"])]),_:1}),F(r,{label:"\u7528\u6237\u540D",prop:"user"},{default:j(()=>[F(a,{type:"text",modelValue:l.form.user,"onUpdate:modelValue":k[1]||(k[1]=_=>l.form.user=_),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),F(r,{label:"\u9A8C\u8BC1\u65B9\u5F0F",prop:"auth_type"},{default:j(()=>[F(p,{modelValue:l.form.auth_type,"onUpdate:modelValue":k[2]||(k[2]=_=>l.form.auth_type=_)},{default:j(()=>[(nt(!0),pt(Tt,null,Pt(l.HostAuthTypeOptions,_=>(nt(),gt(d,{key:_.value,label:_.label,value:_.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l.HostAuthTypeEnum.PRIVATE_KEY==l.form.auth_type?(nt(),gt(r,{key:0,label:"\u79C1\u94A5\u8BC1\u4E66",prop:"private_key"},{default:j(()=>[F(a,{type:"textarea",rows:5,modelValue:l.form.private_key,"onUpdate:modelValue":k[3]||(k[3]=_=>l.form.private_key=_),"show-password":"",spellcheck:!1,placeholder:"\u8BF7\u8F93\u5165\u79C1\u94A5\u8BC1\u4E66"},null,8,["modelValue"])]),_:1})):(nt(),gt(r,{key:1,label:"\u5BC6\u7801",prop:"password"},{default:j(()=>[F(a,{type:"password",modelValue:l.form.password,"onUpdate:modelValue":k[4]||(k[4]=_=>l.form.password=_),"show-password":"",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1}))]),_:1},8,["model","rules"]),lt("div",De,[F(y,{onClick:i.handleCancel},{default:j(()=>[bt(dt(b.$t("\u53D6\u6D88")),1)]),_:1},8,["onClick"]),F(y,{type:"primary",onClick:i.handleSubmit},{default:j(()=>[bt(dt(b.$t("\u786E\u5B9A")),1)]),_:1},8,["onClick"])])])}const Ae=_t(xe,[["render",ze]]),Ee={name:"",props:{row:{type:Object,default:null},visible:{type:Boolean,default:!1}},emits:["update:visible"],components:{DataForm:Ae},data(){return{}},computed:{dialogTitle(){return this.row&&this.row.id?"\u7F16\u8F91\u4E3B\u673A":"\u6DFB\u52A0\u4E3B\u673A"},dialogVisible:{get(){return this.visible},set(b){this.$emit("update:visible",b)}}},methods:{handleClose(){this.$emit("update:visible",!1)},handleOpen(){this.$emit("update:visible",!0)},handleSuccess(b){this.handleClose(),this.$emit("on-success",b)}},created(){}};function Oe(b,k,n,A,l,i){const a=W("DataForm"),r=W("el-dialog");return nt(),gt(r,{title:i.dialogTitle,modelValue:i.dialogVisible,"onUpdate:modelValue":k[0]||(k[0]=d=>i.dialogVisible=d),width:"400px",center:"","append-to-body":""},{default:j(()=>[i.dialogVisible?(nt(),gt(a,{key:0,row:n.row,onOnCancel:i.handleClose,onOnSuccess:i.handleSuccess},null,8,["row","onOnCancel","onOnSuccess"])):Dt("",!0)]),_:1},8,["title","modelValue"])}const Ie=_t(Ee,[["render",Oe]]),Fe={name:"RemoteHost",props:{defaultKeyword:{type:String,default:""},modelValue:{type:Object,default:null}},emits:["on-confirm","update:modelValue"],components:{DataFormDialog:Ie},data(){return{visible:!1,keyword:"",list:[],editValue:null}},computed:{disabled(){return!(this.modelValue&&this.modelValue.id)},value:{get(){return this.modelValue},set(b){this.$emit("update:modelValue",b)}}},methods:{async getData(){this.defaultKeyword&&(this.keyword=this.defaultKeyword)},handleClose(){this.value=null},handleAddClick(){this.editValue={host:this.keyword},this.visible=!0},handleEditHost(){this.editValue=this.value,this.visible=!0},async handleSearch(b,k){let n={keyword:b};const A=await this.$http.getHostList(n);A.code==0?k(A.data.list.map(l=>(l.value=l.host,l))):this.$msg.error(A.msg)},handleSelect(b){console.log(b),this.value=b},handleDeployVerifyFile(){this.$emit("on-confirm",this.value)},handleSuccess(b){this.value=b,this.$emit("on-change")}},created(){this.getData()}},Be={class:"flex flex-1 items-center"};function Re(b,k,n,A,l,i){const a=W("el-tag"),r=W("el-autocomplete"),d=W("Plus"),p=W("el-icon"),v=W("el-link"),y=W("el-button"),_=W("DataFormDialog");return nt(),pt("div",Be,[i.value&&i.value.id?(nt(),gt(a,{key:0,class:"cursor-pointer",closable:"",onClose:i.handleClose,onClick:i.handleEditHost},{default:j(()=>[bt(dt(i.value.user)+"@"+dt(i.value.host),1)]),_:1},8,["onClose","onClick"])):(nt(),pt(Tt,{key:1},[F(r,{modelValue:l.keyword,"onUpdate:modelValue":k[0]||(k[0]=o=>l.keyword=o),style:{width:"180px"},"fetch-suggestions":i.handleSearch,clearable:"",placeholder:b.$t("\u641C\u7D22\u4E3B\u673A"),onSelect:i.handleSelect},null,8,["modelValue","fetch-suggestions","placeholder","onSelect"]),F(v,{class:"ml-sm",underline:!1,type:"primary",onClick:i.handleAddClick},{default:j(()=>[F(p,null,{default:j(()=>[F(d)]),_:1}),lt("span",null,dt(b.$t("\u6DFB\u52A0")),1)]),_:1},8,["onClick"])],64)),F(y,{class:"ml-md ml-auto",disabled:i.disabled,onClick:i.handleDeployVerifyFile},{default:j(()=>[bt(dt(b.$t("\u4E00\u952E\u90E8\u7F72")),1)]),_:1},8,["disabled","onClick"]),F(_,{visible:l.visible,"onUpdate:visible":k[1]||(k[1]=o=>l.visible=o),row:l.editValue,onOnSuccess:i.handleSuccess},null,8,["visible","row","onOnSuccess"])])}const Nt=_t(Fe,[["render",Re]]);const $e={name:"CodeHighlight",props:{value:{type:String,default:""},language:{type:String,default:"nginx"}},components:{},data(){return{}},computed:{highlightValue(){return Rt.highlight(this.value,{language:this.language}).value}},methods:{async getData(){}},mounted(){Rt.highlightAll()},created(){this.getData()}},Te={class:"code-highlight"},Ve=["innerHTML"];function Pe(b,k,n,A,l,i){return nt(),pt("div",Te,[lt("pre",null,[lt("code",{innerHTML:i.highlightValue},null,8,Ve)])])}const Zt=_t($e,[["render",Pe]]);const Ue={name:"VerifyStep",props:{form:{type:Object},list:{type:Array}},emits:["on-success"],components:{VerifyStepFileDataTable:ke,RemoteHost:Nt,CodeHighlight:Zt},data(){return{host:"",hasInit:!1,deployForm:{deploy_host:null,verifyDeployPath:""},rules:{deploy_host:[{message:"\u670D\u52A1\u5668\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],verifyDeployPath:[{message:"\u670D\u52A1\u5668\u90E8\u7F72\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}]}}},computed:{domain_list(){return this.form.domains.join(" ")},nginxConfig(){return`server {
  listen 80;
  server_name ${this.domain_list};

  location /.well-known/acme-challenge/ {
      alias ${this.deployForm.verifyDeployPath};
      try_files $uri = 404;
  }
}`}},methods:{async getData(){await this.getDomainHost(),this.hasInit=!0},async getDomainHost(){let b={domain:this.form.domains[0]};const k=await this.$http.getDomainHost(b);k.code==0?(this.host=k.data.host,this.host&&await this.getHost()):this.$msg.error(k.msg)},async getHost(){let b={host:this.host};const k=await this.$http.getHostList(b);k.data.list&&k.data.list.length>0&&(this.deployForm.deploy_host=k.data.list[0])},async handleVerifyCertificateById(){let b=this.$loading({fullscreen:!0}),k={issue_certificate_id:this.form.id,challenge_type:"http-01"};const n=await this.$http.verifyCertificateById(k);n.code==0?(this.$msg.success("\u9A8C\u8BC1\u6210\u529F"),this.$emit("on-success",n.data)):this.$msg.error(n.msg),this.$nextTick(()=>{b.close()})},downloadVerifyFile(){let b=new Blob([this.form.validation],{type:"application/octet-stream;charset=utf-8"});xt.saveAs(b,this.form.token)},async handleDeployVerifyFile(b){this.$refs.form.validate(k=>{if(k)this.confirmDeployVerifyFile(b);else return!1})},async confirmDeployVerifyFile(b){let k=this.$loading({fullscreen:!0}),n={issue_certificate_id:this.form.id,host_id:b.id,verify_deploy_path:this.deployForm.verifyDeployPath,challenges:this.list};const A=await this.$http.deployVerifyFile(n);A.code==0?(this.$msg.success("\u90E8\u7F72\u6210\u529F"),this.$emit("on-success",A.data)):this.$msg.error(A.msg),this.$nextTick(()=>{k.close()})},handleChangeHost(){this.$refs.form.validateField(["deploy_host"])}},created(){this.deployForm.verifyDeployPath="/var/www/challenges/",this.getData()}},Ne={class:""},Le={class:"text-center mt-md"};function je(b,k,n,A,l,i){const a=W("VerifyStepFileDataTable"),r=W("RemoteHost"),d=W("el-form-item"),p=W("el-input"),v=W("CodeHighlight"),y=W("el-form"),_=W("el-button");return nt(),pt("div",Ne,[F(a,{form:n.form,list:n.list,"challenge-type":"http-01"},null,8,["form","list"]),F(y,{ref:"form","label-width":"130px",class:"mt-md",model:l.deployForm,rules:l.rules},{default:j(()=>[F(d,{label:b.$t("\u670D\u52A1\u5668\u5730\u5740"),prop:"deploy_host"},{default:j(()=>[l.hasInit?(nt(),gt(r,{key:0,defaultKeyword:l.host,modelValue:l.deployForm.deploy_host,"onUpdate:modelValue":k[0]||(k[0]=o=>l.deployForm.deploy_host=o),onOnChange:i.handleChangeHost,onOnConfirm:i.handleDeployVerifyFile},null,8,["defaultKeyword","modelValue","onOnChange","onOnConfirm"])):Dt("",!0)]),_:1},8,["label"]),F(d,{label:b.$t("\u670D\u52A1\u5668\u76EE\u5F55"),prop:"verifyDeployPath"},{default:j(()=>[F(p,{modelValue:l.deployForm.verifyDeployPath,"onUpdate:modelValue":k[1]||(k[1]=o=>l.deployForm.verifyDeployPath=o)},null,8,["modelValue"])]),_:1},8,["label"]),F(d,{label:b.$t("Nginx\u914D\u7F6E"),prop:"isp"},{default:j(()=>[F(v,{value:i.nginxConfig},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model","rules"]),lt("div",Le,[F(_,{type:"primary",onClick:i.handleVerifyCertificateById},{default:j(()=>[bt(dt(b.$t("\u9A8C\u8BC1")),1)]),_:1},8,["onClick"])])])}const He=_t(Ue,[["render",je],["__scopeId","data-v-da4fd5f6"]]);const We={name:"VerifyStep",props:{form:{type:Object}},emits:["on-success"],components:{VerifyStepDNS:ge,VerifyStepFile:He},data(){return{list:[],activeName:"file"}},computed:{fileList(){return this.list.filter(b=>b.challenge&&b.challenge.type=="http-01").map(b=>(b.verify_path="/.well-known/acme-challenge/"+b.token,b.verify_url="http://"+b.domain+b.verify_path,b))},dnsList(){return this.list.filter(b=>b.challenge&&b.challenge.type=="dns-01")}},methods:{async getData(){this.loading=!0;let b={issue_certificate_id:this.form.id};try{const k=await this.$http.getCertificateChallenges(b);this.list=k.data.list.map(n=>(n.challenge&&(n={...n.challenge,...n}),n.status=="valid"?n.status_value=!0:n.status=="invalid"?n.status_value=!1:n.status_value=null,n)),console.log(this.list),this.total=k.data.total}catch(k){console.log(k)}finally{this.loading=!1}},handleSuccess(){this.$emit("on-success")}},mounted(){},created(){this.getData()}},Ze={class:""};function Me(b,k,n,A,l,i){const a=W("VerifyStepFile"),r=W("el-tab-pane"),d=W("VerifyStepDNS"),p=W("el-tabs");return nt(),pt("div",Ze,[F(p,{modelValue:l.activeName,"onUpdate:modelValue":k[0]||(k[0]=v=>l.activeName=v)},{default:j(()=>[F(r,{label:b.$t("\u6587\u4EF6\u9A8C\u8BC1"),name:"file",lazy:""},{default:j(()=>[F(a,{form:n.form,list:i.fileList,onOnSuccess:i.handleSuccess},null,8,["form","list","onOnSuccess"])]),_:1},8,["label"]),F(r,{label:b.$t("DNS\u9A8C\u8BC1"),name:"dns",lazy:""},{default:j(()=>[F(d,{form:n.form,list:i.dnsList,onOnSuccess:i.handleSuccess},null,8,["form","list","onOnSuccess"])]),_:1},8,["label"])]),_:1},8,["modelValue"])])}const Ke=_t(We,[["render",Me],["__scopeId","data-v-cd087152"]]);const Ge={name:"VerifyStep",props:{form:{type:Object}},emits:["on-success"],components:{RemoteHost:Nt},data(){return{hasInit:!1,host:"",keyDeployPath:"",pemDeployPath:""}},computed:{domain_list(){return this.form.domains.join(" ")},nginxConfig(){return te(this.nginxConfigTemplate,{language:"nginx"}).value}},methods:{async getData(){this.keyDeployPath=`/path/to/${this.form.domains[0]}.key`,this.pemDeployPath=`/path/to/${this.form.domains[0]}.pem`},handleClose(){this.$emit("on-close")},async handleSubmit(){let b=this.$loading({fullscreen:!0}),k={issue_certificate_id:this.form.id};const n=await this.$http.renewCertificate(k);return n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg),this.$nextTick(()=>{b.close()}),n},downloadSSLKeyFile(){console.log(JSON.stringify(this.form,null,2));let b=new Blob([this.form.ssl_certificate_key],{type:"text/plain;charset=utf-8"}),k=this.form.domains[0];xt.saveAs(b,`${k}.key`)},async downloadSSLFile(){if(!this.form.ssl_certificate){const n=await this.handleSubmit();this.form.ssl_certificate=n.data.ssl_certificate}let b=new Blob([this.form.ssl_certificate],{type:"text/plain;charset=utf-8"}),k=this.form.domains[0];xt.saveAs(b,`${k}.pem`)},async getDomainHost(){let b={domain:this.form.domains[0]};const k=await this.$http.getDomainHost(b);k.code==0?this.host=k.data.host:this.$msg.error(k.msg),this.hasInit=!0},handleDeployVerifyFile(){}},mounted(){Rt.highlightAll()},created(){this.getDomainHost(),this.getData()}},qe={class:"text-center mt-md"};function Ye(b,k,n,A,l,i){const a=W("el-button");return nt(),pt("div",null,[lt("div",qe,[F(a,{type:"primary",onClick:i.handleSubmit},{default:j(()=>[bt("\u7533 \u8BF7")]),_:1},8,["onClick"])])])}const Xe=_t(Ge,[["render",Ye],["__scopeId","data-v-ba24cbba"]]);function Bt(b){throw new Error('Could not dynamically require "'+b+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Mt={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(b,k){(function(n){b.exports=n()})(function(){return function n(A,l,i){function a(p,v){if(!l[p]){if(!A[p]){var y=typeof Bt=="function"&&Bt;if(!v&&y)return y(p,!0);if(r)return r(p,!0);var _=new Error("Cannot find module '"+p+"'");throw _.code="MODULE_NOT_FOUND",_}var o=l[p]={exports:{}};A[p][0].call(o.exports,function(m){var s=A[p][1][m];return a(s||m)},o,o.exports,n,A,l,i)}return l[p].exports}for(var r=typeof Bt=="function"&&Bt,d=0;d<i.length;d++)a(i[d]);return a}({1:[function(n,A,l){var i=n("./utils"),a=n("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";l.encode=function(d){for(var p,v,y,_,o,m,s,h=[],u=0,g=d.length,S=g,C=i.getTypeOf(d)!=="string";u<d.length;)S=g-u,y=C?(p=d[u++],v=u<g?d[u++]:0,u<g?d[u++]:0):(p=d.charCodeAt(u++),v=u<g?d.charCodeAt(u++):0,u<g?d.charCodeAt(u++):0),_=p>>2,o=(3&p)<<4|v>>4,m=1<S?(15&v)<<2|y>>6:64,s=2<S?63&y:64,h.push(r.charAt(_)+r.charAt(o)+r.charAt(m)+r.charAt(s));return h.join("")},l.decode=function(d){var p,v,y,_,o,m,s=0,h=0,u="data:";if(d.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var g,S=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===r.charAt(64)&&S--,d.charAt(d.length-2)===r.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(g=a.uint8array?new Uint8Array(0|S):new Array(0|S);s<d.length;)p=r.indexOf(d.charAt(s++))<<2|(_=r.indexOf(d.charAt(s++)))>>4,v=(15&_)<<4|(o=r.indexOf(d.charAt(s++)))>>2,y=(3&o)<<6|(m=r.indexOf(d.charAt(s++))),g[h++]=p,o!==64&&(g[h++]=v),m!==64&&(g[h++]=y);return g}},{"./support":30,"./utils":32}],2:[function(n,A,l){var i=n("./external"),a=n("./stream/DataWorker"),r=n("./stream/Crc32Probe"),d=n("./stream/DataLengthProbe");function p(v,y,_,o,m){this.compressedSize=v,this.uncompressedSize=y,this.crc32=_,this.compression=o,this.compressedContent=m}p.prototype={getContentWorker:function(){var v=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),y=this;return v.on("end",function(){if(this.streamInfo.data_length!==y.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},p.createWorkerFrom=function(v,y,_){return v.pipe(new r).pipe(new d("uncompressedSize")).pipe(y.compressWorker(_)).pipe(new d("compressedSize")).withStreamInfo("compression",y)},A.exports=p},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,A,l){var i=n("./stream/GenericWorker");l.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},l.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,A,l){var i=n("./utils"),a=function(){for(var r,d=[],p=0;p<256;p++){r=p;for(var v=0;v<8;v++)r=1&r?3988292384^r>>>1:r>>>1;d[p]=r}return d}();A.exports=function(r,d){return r!==void 0&&r.length?i.getTypeOf(r)!=="string"?function(p,v,y,_){var o=a,m=_+y;p^=-1;for(var s=_;s<m;s++)p=p>>>8^o[255&(p^v[s])];return-1^p}(0|d,r,r.length,0):function(p,v,y,_){var o=a,m=_+y;p^=-1;for(var s=_;s<m;s++)p=p>>>8^o[255&(p^v.charCodeAt(s))];return-1^p}(0|d,r,r.length,0):0}},{"./utils":32}],5:[function(n,A,l){l.base64=!1,l.binary=!1,l.dir=!1,l.createFolders=!0,l.date=null,l.compression=null,l.compressionOptions=null,l.comment=null,l.unixPermissions=null,l.dosPermissions=null},{}],6:[function(n,A,l){var i=null;i=typeof Promise<"u"?Promise:n("lie"),A.exports={Promise:i}},{lie:37}],7:[function(n,A,l){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),r=n("./utils"),d=n("./stream/GenericWorker"),p=i?"uint8array":"array";function v(y,_){d.call(this,"FlateWorker/"+y),this._pako=null,this._pakoAction=y,this._pakoOptions=_,this.meta={}}l.magic="\b\0",r.inherits(v,d),v.prototype.processChunk=function(y){this.meta=y.meta,this._pako===null&&this._createPako(),this._pako.push(r.transformTo(p,y.data),!1)},v.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var y=this;this._pako.onData=function(_){y.push({data:_,meta:y.meta})}},l.compressWorker=function(y){return new v("Deflate",y)},l.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,A,l){function i(o,m){var s,h="";for(s=0;s<m;s++)h+=String.fromCharCode(255&o),o>>>=8;return h}function a(o,m,s,h,u,g){var S,C,D=o.file,P=o.compression,R=g!==p.utf8encode,H=r.transformTo("string",g(D.name)),B=r.transformTo("string",p.utf8encode(D.name)),G=D.comment,tt=r.transformTo("string",g(G)),w=r.transformTo("string",p.utf8encode(G)),$=B.length!==D.name.length,e=w.length!==G.length,V="",rt="",L="",it=D.dir,Z=D.date,et={crc32:0,compressedSize:0,uncompressedSize:0};m&&!s||(et.crc32=o.crc32,et.compressedSize=o.compressedSize,et.uncompressedSize=o.uncompressedSize);var O=0;m&&(O|=8),R||!$&&!e||(O|=2048);var E=0,Q=0;it&&(E|=16),u==="UNIX"?(Q=798,E|=function(q,ct){var yt=q;return q||(yt=ct?16893:33204),(65535&yt)<<16}(D.unixPermissions,it)):(Q=20,E|=function(q){return 63&(q||0)}(D.dosPermissions)),S=Z.getUTCHours(),S<<=6,S|=Z.getUTCMinutes(),S<<=5,S|=Z.getUTCSeconds()/2,C=Z.getUTCFullYear()-1980,C<<=4,C|=Z.getUTCMonth()+1,C<<=5,C|=Z.getUTCDate(),$&&(rt=i(1,1)+i(v(H),4)+B,V+="up"+i(rt.length,2)+rt),e&&(L=i(1,1)+i(v(tt),4)+w,V+="uc"+i(L.length,2)+L);var Y="";return Y+=`
\0`,Y+=i(O,2),Y+=P.magic,Y+=i(S,2),Y+=i(C,2),Y+=i(et.crc32,4),Y+=i(et.compressedSize,4),Y+=i(et.uncompressedSize,4),Y+=i(H.length,2),Y+=i(V.length,2),{fileRecord:y.LOCAL_FILE_HEADER+Y+H+V,dirRecord:y.CENTRAL_FILE_HEADER+i(Q,2)+Y+i(tt.length,2)+"\0\0\0\0"+i(E,4)+i(h,4)+H+V+tt}}var r=n("../utils"),d=n("../stream/GenericWorker"),p=n("../utf8"),v=n("../crc32"),y=n("../signature");function _(o,m,s,h){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=s,this.encodeFileName=h,this.streamFiles=o,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(_,d),_.prototype.push=function(o){var m=o.meta.percent||0,s=this.entriesCount,h=this._sources.length;this.accumulate?this.contentBuffer.push(o):(this.bytesWritten+=o.data.length,d.prototype.push.call(this,{data:o.data,meta:{currentFile:this.currentFile,percent:s?(m+100*(s-h-1))/s:100}}))},_.prototype.openedSource=function(o){this.currentSourceOffset=this.bytesWritten,this.currentFile=o.file.name;var m=this.streamFiles&&!o.file.dir;if(m){var s=a(o,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:s.fileRecord,meta:{percent:0}})}else this.accumulate=!0},_.prototype.closedSource=function(o){this.accumulate=!1;var m=this.streamFiles&&!o.file.dir,s=a(o,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(s.dirRecord),m)this.push({data:function(h){return y.DATA_DESCRIPTOR+i(h.crc32,4)+i(h.compressedSize,4)+i(h.uncompressedSize,4)}(o),meta:{percent:100}});else for(this.push({data:s.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},_.prototype.flush=function(){for(var o=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var s=this.bytesWritten-o,h=function(u,g,S,C,D){var P=r.transformTo("string",D(C));return y.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(u,2)+i(u,2)+i(g,4)+i(S,4)+i(P.length,2)+P}(this.dirRecords.length,s,o,this.zipComment,this.encodeFileName);this.push({data:h,meta:{percent:100}})},_.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},_.prototype.registerPrevious=function(o){this._sources.push(o);var m=this;return o.on("data",function(s){m.processChunk(s)}),o.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),o.on("error",function(s){m.error(s)}),this},_.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},_.prototype.error=function(o){var m=this._sources;if(!d.prototype.error.call(this,o))return!1;for(var s=0;s<m.length;s++)try{m[s].error(o)}catch{}return!0},_.prototype.lock=function(){d.prototype.lock.call(this);for(var o=this._sources,m=0;m<o.length;m++)o[m].lock()},A.exports=_},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,A,l){var i=n("../compressions"),a=n("./ZipFileWorker");l.generateWorker=function(r,d,p){var v=new a(d.streamFiles,p,d.platform,d.encodeFileName),y=0;try{r.forEach(function(_,o){y++;var m=function(g,S){var C=g||S,D=i[C];if(!D)throw new Error(C+" is not a valid compression method !");return D}(o.options.compression,d.compression),s=o.options.compressionOptions||d.compressionOptions||{},h=o.dir,u=o.date;o._compressWorker(m,s).withStreamInfo("file",{name:_,dir:h,date:u,comment:o.comment||"",unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions}).pipe(v)}),v.entriesCount=y}catch(_){v.error(_)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,A,l){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var r in this)typeof this[r]!="function"&&(a[r]=this[r]);return a}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(a,r){return new i().loadAsync(a,r)},i.external=n("./external"),A.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,A,l){var i=n("./utils"),a=n("./external"),r=n("./utf8"),d=n("./zipEntries"),p=n("./stream/Crc32Probe"),v=n("./nodejsUtils");function y(_){return new a.Promise(function(o,m){var s=_.decompressed.getContentWorker().pipe(new p);s.on("error",function(h){m(h)}).on("end",function(){s.streamInfo.crc32!==_.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):o()}).resume()})}A.exports=function(_,o){var m=this;return o=i.extend(o||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),v.isNode&&v.isStream(_)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",_,!0,o.optimizedBinaryString,o.base64).then(function(s){var h=new d(o);return h.load(s),h}).then(function(s){var h=[a.Promise.resolve(s)],u=s.files;if(o.checkCRC32)for(var g=0;g<u.length;g++)h.push(y(u[g]));return a.Promise.all(h)}).then(function(s){for(var h=s.shift(),u=h.files,g=0;g<u.length;g++){var S=u[g],C=S.fileNameStr,D=i.resolve(S.fileNameStr);m.file(D,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:o.createFolders}),S.dir||(m.file(D).unsafeOriginalName=C)}return h.zipComment.length&&(m.comment=h.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,A,l){var i=n("../utils"),a=n("../stream/GenericWorker");function r(d,p){a.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(p)}i.inherits(r,a),r.prototype._bindStream=function(d){var p=this;(this._stream=d).pause(),d.on("data",function(v){p.push({data:v,meta:{percent:0}})}).on("error",function(v){p.isPaused?this.generatedError=v:p.error(v)}).on("end",function(){p.isPaused?p._upstreamEnded=!0:p.end()})},r.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},A.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,A,l){var i=n("readable-stream").Readable;function a(r,d,p){i.call(this,d),this._helper=r;var v=this;r.on("data",function(y,_){v.push(y)||v._helper.pause(),p&&p(_)}).on("error",function(y){v.emit("error",y)}).on("end",function(){v.push(null)})}n("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},A.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,A,l){A.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,a)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var a=new Buffer(i);return a.fill(0),a},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,A,l){function i(D,P,R){var H,B=r.getTypeOf(P),G=r.extend(R||{},v);G.date=G.date||new Date,G.compression!==null&&(G.compression=G.compression.toUpperCase()),typeof G.unixPermissions=="string"&&(G.unixPermissions=parseInt(G.unixPermissions,8)),G.unixPermissions&&16384&G.unixPermissions&&(G.dir=!0),G.dosPermissions&&16&G.dosPermissions&&(G.dir=!0),G.dir&&(D=u(D)),G.createFolders&&(H=h(D))&&g.call(this,H,!0);var tt=B==="string"&&G.binary===!1&&G.base64===!1;R&&R.binary!==void 0||(G.binary=!tt),(P instanceof y&&P.uncompressedSize===0||G.dir||!P||P.length===0)&&(G.base64=!1,G.binary=!0,P="",G.compression="STORE",B="string");var w=null;w=P instanceof y||P instanceof d?P:m.isNode&&m.isStream(P)?new s(D,P):r.prepareContent(D,P,G.binary,G.optimizedBinaryString,G.base64);var $=new _(D,w,G);this.files[D]=$}var a=n("./utf8"),r=n("./utils"),d=n("./stream/GenericWorker"),p=n("./stream/StreamHelper"),v=n("./defaults"),y=n("./compressedObject"),_=n("./zipObject"),o=n("./generate"),m=n("./nodejsUtils"),s=n("./nodejs/NodejsStreamInputAdapter"),h=function(D){D.slice(-1)==="/"&&(D=D.substring(0,D.length-1));var P=D.lastIndexOf("/");return 0<P?D.substring(0,P):""},u=function(D){return D.slice(-1)!=="/"&&(D+="/"),D},g=function(D,P){return P=P!==void 0?P:v.createFolders,D=u(D),this.files[D]||i.call(this,D,null,{dir:!0,createFolders:P}),this.files[D]};function S(D){return Object.prototype.toString.call(D)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(D){var P,R,H;for(P in this.files)H=this.files[P],(R=P.slice(this.root.length,P.length))&&P.slice(0,this.root.length)===this.root&&D(R,H)},filter:function(D){var P=[];return this.forEach(function(R,H){D(R,H)&&P.push(H)}),P},file:function(D,P,R){if(arguments.length!==1)return D=this.root+D,i.call(this,D,P,R),this;if(S(D)){var H=D;return this.filter(function(G,tt){return!tt.dir&&H.test(G)})}var B=this.files[this.root+D];return B&&!B.dir?B:null},folder:function(D){if(!D)return this;if(S(D))return this.filter(function(B,G){return G.dir&&D.test(B)});var P=this.root+D,R=g.call(this,P),H=this.clone();return H.root=R.name,H},remove:function(D){D=this.root+D;var P=this.files[D];if(P||(D.slice(-1)!=="/"&&(D+="/"),P=this.files[D]),P&&!P.dir)delete this.files[D];else for(var R=this.filter(function(B,G){return G.name.slice(0,D.length)===D}),H=0;H<R.length;H++)delete this.files[R[H].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(D){var P,R={};try{if((R=r.extend(D||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");r.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var H=R.comment||this.comment||"";P=o.generateWorker(this,R,H)}catch(B){(P=new d("error")).error(B)}return new p(P,R.type||"string",R.mimeType)},generateAsync:function(D,P){return this.generateInternalStream(D).accumulate(P)},generateNodeStream:function(D,P){return(D=D||{}).type||(D.type="nodebuffer"),this.generateInternalStream(D).toNodejsStream(P)}};A.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,A,l){A.exports=n("stream")},{stream:void 0}],17:[function(n,A,l){var i=n("./DataReader");function a(r){i.call(this,r);for(var d=0;d<this.data.length;d++)r[d]=255&r[d]}n("../utils").inherits(a,i),a.prototype.byteAt=function(r){return this.data[this.zero+r]},a.prototype.lastIndexOfSignature=function(r){for(var d=r.charCodeAt(0),p=r.charCodeAt(1),v=r.charCodeAt(2),y=r.charCodeAt(3),_=this.length-4;0<=_;--_)if(this.data[_]===d&&this.data[_+1]===p&&this.data[_+2]===v&&this.data[_+3]===y)return _-this.zero;return-1},a.prototype.readAndCheckSignature=function(r){var d=r.charCodeAt(0),p=r.charCodeAt(1),v=r.charCodeAt(2),y=r.charCodeAt(3),_=this.readData(4);return d===_[0]&&p===_[1]&&v===_[2]&&y===_[3]},a.prototype.readData=function(r){if(this.checkOffset(r),r===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,d},A.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,A,l){var i=n("../utils");function a(r){this.data=r,this.length=r.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(r){this.checkIndex(this.index+r)},checkIndex:function(r){if(this.length<this.zero+r||r<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+r+"). Corrupted zip ?")},setIndex:function(r){this.checkIndex(r),this.index=r},skip:function(r){this.setIndex(this.index+r)},byteAt:function(){},readInt:function(r){var d,p=0;for(this.checkOffset(r),d=this.index+r-1;d>=this.index;d--)p=(p<<8)+this.byteAt(d);return this.index+=r,p},readString:function(r){return i.transformTo("string",this.readData(r))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var r=this.readInt(4);return new Date(Date.UTC(1980+(r>>25&127),(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(31&r)<<1))}},A.exports=a},{"../utils":32}],19:[function(n,A,l){var i=n("./Uint8ArrayReader");function a(r){i.call(this,r)}n("../utils").inherits(a,i),a.prototype.readData=function(r){this.checkOffset(r);var d=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,d},A.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,A,l){var i=n("./DataReader");function a(r){i.call(this,r)}n("../utils").inherits(a,i),a.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},a.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},a.prototype.readAndCheckSignature=function(r){return r===this.readData(4)},a.prototype.readData=function(r){this.checkOffset(r);var d=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,d},A.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,A,l){var i=n("./ArrayReader");function a(r){i.call(this,r)}n("../utils").inherits(a,i),a.prototype.readData=function(r){if(this.checkOffset(r),r===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,d},A.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,A,l){var i=n("../utils"),a=n("../support"),r=n("./ArrayReader"),d=n("./StringReader"),p=n("./NodeBufferReader"),v=n("./Uint8ArrayReader");A.exports=function(y){var _=i.getTypeOf(y);return i.checkSupport(_),_!=="string"||a.uint8array?_==="nodebuffer"?new p(y):a.uint8array?new v(i.transformTo("uint8array",y)):new r(i.transformTo("array",y)):new d(y)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,A,l){l.LOCAL_FILE_HEADER="PK",l.CENTRAL_FILE_HEADER="PK",l.CENTRAL_DIRECTORY_END="PK",l.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",l.ZIP64_CENTRAL_DIRECTORY_END="PK",l.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,A,l){var i=n("./GenericWorker"),a=n("../utils");function r(d){i.call(this,"ConvertWorker to "+d),this.destType=d}a.inherits(r,i),r.prototype.processChunk=function(d){this.push({data:a.transformTo(this.destType,d.data),meta:d.meta})},A.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(n,A,l){var i=n("./GenericWorker"),a=n("../crc32");function r(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(r,i),r.prototype.processChunk=function(d){this.streamInfo.crc32=a(d.data,this.streamInfo.crc32||0),this.push(d)},A.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,A,l){var i=n("../utils"),a=n("./GenericWorker");function r(d){a.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}i.inherits(r,a),r.prototype.processChunk=function(d){if(d){var p=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=p+d.data.length}a.prototype.processChunk.call(this,d)},A.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(n,A,l){var i=n("../utils"),a=n("./GenericWorker");function r(d){a.call(this,"DataWorker");var p=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(v){p.dataIsReady=!0,p.data=v,p.max=v&&v.length||0,p.type=i.getTypeOf(v),p.isPaused||p._tickAndRepeat()},function(v){p.error(v)})}i.inherits(r,a),r.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,p=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,p);break;case"uint8array":d=this.data.subarray(this.index,p);break;case"array":case"nodebuffer":d=this.data.slice(this.index,p)}return this.index=p,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},A.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(n,A,l){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,r){return this._listeners[a].push(r),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,r){if(this._listeners[a])for(var d=0;d<this._listeners[a].length;d++)this._listeners[a][d].call(this,r)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var r=this;return a.on("data",function(d){r.processChunk(d)}),a.on("end",function(){r.end()}),a.on("error",function(d){r.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,r){return this.extraStreamInfo[a]=r,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},A.exports=i},{}],29:[function(n,A,l){var i=n("../utils"),a=n("./ConvertWorker"),r=n("./GenericWorker"),d=n("../base64"),p=n("../support"),v=n("../external"),y=null;if(p.nodestream)try{y=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function _(m,s){return new v.Promise(function(h,u){var g=[],S=m._internalType,C=m._outputType,D=m._mimeType;m.on("data",function(P,R){g.push(P),s&&s(R)}).on("error",function(P){g=[],u(P)}).on("end",function(){try{var P=function(R,H,B){switch(R){case"blob":return i.newBlob(i.transformTo("arraybuffer",H),B);case"base64":return d.encode(H);default:return i.transformTo(R,H)}}(C,function(R,H){var B,G=0,tt=null,w=0;for(B=0;B<H.length;B++)w+=H[B].length;switch(R){case"string":return H.join("");case"array":return Array.prototype.concat.apply([],H);case"uint8array":for(tt=new Uint8Array(w),B=0;B<H.length;B++)tt.set(H[B],G),G+=H[B].length;return tt;case"nodebuffer":return Buffer.concat(H);default:throw new Error("concat : unsupported type '"+R+"'")}}(S,g),D);h(P)}catch(R){u(R)}g=[]}).resume()})}function o(m,s,h){var u=s;switch(s){case"blob":case"arraybuffer":u="uint8array";break;case"base64":u="string"}try{this._internalType=u,this._outputType=s,this._mimeType=h,i.checkSupport(u),this._worker=m.pipe(new a(u)),m.lock()}catch(g){this._worker=new r("error"),this._worker.error(g)}}o.prototype={accumulate:function(m){return _(this,m)},on:function(m,s){var h=this;return m==="data"?this._worker.on(m,function(u){s.call(h,u.data,u.meta)}):this._worker.on(m,function(){i.delay(s,arguments,h)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new y(this,{objectMode:this._outputType!=="nodebuffer"},m)}},A.exports=o},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,A,l){if(l.base64=!0,l.array=!0,l.string=!0,l.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",l.nodebuffer=typeof Buffer<"u",l.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")l.blob=!1;else{var i=new ArrayBuffer(0);try{l.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),l.blob=a.getBlob("application/zip").size===0}catch{l.blob=!1}}}try{l.nodestream=!!n("readable-stream").Readable}catch{l.nodestream=!1}},{"readable-stream":16}],31:[function(n,A,l){for(var i=n("./utils"),a=n("./support"),r=n("./nodejsUtils"),d=n("./stream/GenericWorker"),p=new Array(256),v=0;v<256;v++)p[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;p[254]=p[254]=1;function y(){d.call(this,"utf-8 decode"),this.leftOver=null}function _(){d.call(this,"utf-8 encode")}l.utf8encode=function(o){return a.nodebuffer?r.newBufferFrom(o,"utf-8"):function(m){var s,h,u,g,S,C=m.length,D=0;for(g=0;g<C;g++)(64512&(h=m.charCodeAt(g)))==55296&&g+1<C&&(64512&(u=m.charCodeAt(g+1)))==56320&&(h=65536+(h-55296<<10)+(u-56320),g++),D+=h<128?1:h<2048?2:h<65536?3:4;for(s=a.uint8array?new Uint8Array(D):new Array(D),g=S=0;S<D;g++)(64512&(h=m.charCodeAt(g)))==55296&&g+1<C&&(64512&(u=m.charCodeAt(g+1)))==56320&&(h=65536+(h-55296<<10)+(u-56320),g++),h<128?s[S++]=h:(h<2048?s[S++]=192|h>>>6:(h<65536?s[S++]=224|h>>>12:(s[S++]=240|h>>>18,s[S++]=128|h>>>12&63),s[S++]=128|h>>>6&63),s[S++]=128|63&h);return s}(o)},l.utf8decode=function(o){return a.nodebuffer?i.transformTo("nodebuffer",o).toString("utf-8"):function(m){var s,h,u,g,S=m.length,C=new Array(2*S);for(s=h=0;s<S;)if((u=m[s++])<128)C[h++]=u;else if(4<(g=p[u]))C[h++]=65533,s+=g-1;else{for(u&=g===2?31:g===3?15:7;1<g&&s<S;)u=u<<6|63&m[s++],g--;1<g?C[h++]=65533:u<65536?C[h++]=u:(u-=65536,C[h++]=55296|u>>10&1023,C[h++]=56320|1023&u)}return C.length!==h&&(C.subarray?C=C.subarray(0,h):C.length=h),i.applyFromCharCode(C)}(o=i.transformTo(a.uint8array?"uint8array":"array",o))},i.inherits(y,d),y.prototype.processChunk=function(o){var m=i.transformTo(a.uint8array?"uint8array":"array",o.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var s=m;(m=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),m.set(s,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var h=function(g,S){var C;for((S=S||g.length)>g.length&&(S=g.length),C=S-1;0<=C&&(192&g[C])==128;)C--;return C<0||C===0?S:C+p[g[C]]>S?C:S}(m),u=m;h!==m.length&&(a.uint8array?(u=m.subarray(0,h),this.leftOver=m.subarray(h,m.length)):(u=m.slice(0,h),this.leftOver=m.slice(h,m.length))),this.push({data:l.utf8decode(u),meta:o.meta})},y.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:l.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},l.Utf8DecodeWorker=y,i.inherits(_,d),_.prototype.processChunk=function(o){this.push({data:l.utf8encode(o.data),meta:o.meta})},l.Utf8EncodeWorker=_},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,A,l){var i=n("./support"),a=n("./base64"),r=n("./nodejsUtils"),d=n("./external");function p(s){return s}function v(s,h){for(var u=0;u<s.length;++u)h[u]=255&s.charCodeAt(u);return h}n("setimmediate"),l.newBlob=function(s,h){l.checkSupport("blob");try{return new Blob([s],{type:h})}catch{try{var u=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return u.append(s),u.getBlob(h)}catch{throw new Error("Bug : can't construct the Blob.")}}};var y={stringifyByChunk:function(s,h,u){var g=[],S=0,C=s.length;if(C<=u)return String.fromCharCode.apply(null,s);for(;S<C;)h==="array"||h==="nodebuffer"?g.push(String.fromCharCode.apply(null,s.slice(S,Math.min(S+u,C)))):g.push(String.fromCharCode.apply(null,s.subarray(S,Math.min(S+u,C)))),S+=u;return g.join("")},stringifyByChar:function(s){for(var h="",u=0;u<s.length;u++)h+=String.fromCharCode(s[u]);return h},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,r.allocBuffer(1)).length===1}catch{return!1}}()}};function _(s){var h=65536,u=l.getTypeOf(s),g=!0;if(u==="uint8array"?g=y.applyCanBeUsed.uint8array:u==="nodebuffer"&&(g=y.applyCanBeUsed.nodebuffer),g)for(;1<h;)try{return y.stringifyByChunk(s,u,h)}catch{h=Math.floor(h/2)}return y.stringifyByChar(s)}function o(s,h){for(var u=0;u<s.length;u++)h[u]=s[u];return h}l.applyFromCharCode=_;var m={};m.string={string:p,array:function(s){return v(s,new Array(s.length))},arraybuffer:function(s){return m.string.uint8array(s).buffer},uint8array:function(s){return v(s,new Uint8Array(s.length))},nodebuffer:function(s){return v(s,r.allocBuffer(s.length))}},m.array={string:_,array:p,arraybuffer:function(s){return new Uint8Array(s).buffer},uint8array:function(s){return new Uint8Array(s)},nodebuffer:function(s){return r.newBufferFrom(s)}},m.arraybuffer={string:function(s){return _(new Uint8Array(s))},array:function(s){return o(new Uint8Array(s),new Array(s.byteLength))},arraybuffer:p,uint8array:function(s){return new Uint8Array(s)},nodebuffer:function(s){return r.newBufferFrom(new Uint8Array(s))}},m.uint8array={string:_,array:function(s){return o(s,new Array(s.length))},arraybuffer:function(s){return s.buffer},uint8array:p,nodebuffer:function(s){return r.newBufferFrom(s)}},m.nodebuffer={string:_,array:function(s){return o(s,new Array(s.length))},arraybuffer:function(s){return m.nodebuffer.uint8array(s).buffer},uint8array:function(s){return o(s,new Uint8Array(s.length))},nodebuffer:p},l.transformTo=function(s,h){if(h=h||"",!s)return h;l.checkSupport(s);var u=l.getTypeOf(h);return m[u][s](h)},l.resolve=function(s){for(var h=s.split("/"),u=[],g=0;g<h.length;g++){var S=h[g];S==="."||S===""&&g!==0&&g!==h.length-1||(S===".."?u.pop():u.push(S))}return u.join("/")},l.getTypeOf=function(s){return typeof s=="string"?"string":Object.prototype.toString.call(s)==="[object Array]"?"array":i.nodebuffer&&r.isBuffer(s)?"nodebuffer":i.uint8array&&s instanceof Uint8Array?"uint8array":i.arraybuffer&&s instanceof ArrayBuffer?"arraybuffer":void 0},l.checkSupport=function(s){if(!i[s.toLowerCase()])throw new Error(s+" is not supported by this platform")},l.MAX_VALUE_16BITS=65535,l.MAX_VALUE_32BITS=-1,l.pretty=function(s){var h,u,g="";for(u=0;u<(s||"").length;u++)g+="\\x"+((h=s.charCodeAt(u))<16?"0":"")+h.toString(16).toUpperCase();return g},l.delay=function(s,h,u){setImmediate(function(){s.apply(u||null,h||[])})},l.inherits=function(s,h){function u(){}u.prototype=h.prototype,s.prototype=new u},l.extend=function(){var s,h,u={};for(s=0;s<arguments.length;s++)for(h in arguments[s])Object.prototype.hasOwnProperty.call(arguments[s],h)&&u[h]===void 0&&(u[h]=arguments[s][h]);return u},l.prepareContent=function(s,h,u,g,S){return d.Promise.resolve(h).then(function(C){return i.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new d.Promise(function(D,P){var R=new FileReader;R.onload=function(H){D(H.target.result)},R.onerror=function(H){P(H.target.error)},R.readAsArrayBuffer(C)}):C}).then(function(C){var D=l.getTypeOf(C);return D?(D==="arraybuffer"?C=l.transformTo("uint8array",C):D==="string"&&(S?C=a.decode(C):u&&g!==!0&&(C=function(P){return v(P,i.uint8array?new Uint8Array(P.length):new Array(P.length))}(C))),C):d.Promise.reject(new Error("Can't read the data of '"+s+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,A,l){var i=n("./reader/readerFor"),a=n("./utils"),r=n("./signature"),d=n("./zipEntry"),p=n("./support");function v(y){this.files=[],this.loadOptions=y}v.prototype={checkSignature:function(y){if(!this.reader.readAndCheckSignature(y)){this.reader.index-=4;var _=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(_)+", expected "+a.pretty(y)+")")}},isSignature:function(y,_){var o=this.reader.index;this.reader.setIndex(y);var m=this.reader.readString(4)===_;return this.reader.setIndex(o),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var y=this.reader.readData(this.zipCommentLength),_=p.uint8array?"uint8array":"array",o=a.transformTo(_,y);this.zipComment=this.loadOptions.decodeFileName(o)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var y,_,o,m=this.zip64EndOfCentralSize-44;0<m;)y=this.reader.readInt(2),_=this.reader.readInt(4),o=this.reader.readData(_),this.zip64ExtensibleData[y]={id:y,length:_,value:o}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var y,_;for(y=0;y<this.files.length;y++)_=this.files[y],this.reader.setIndex(_.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),_.readLocalPart(this.reader),_.handleUTF8(),_.processAttributes()},readCentralDir:function(){var y;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(y=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(y);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var y=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(y<0)throw this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(y);var _=y;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(y=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(y),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var o=this.centralDirOffset+this.centralDirSize;this.zip64&&(o+=20,o+=12+this.zip64EndOfCentralSize);var m=_-o;if(0<m)this.isSignature(_,r.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(y){this.reader=i(y)},load:function(y){this.prepareReader(y),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},A.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,A,l){var i=n("./reader/readerFor"),a=n("./utils"),r=n("./compressedObject"),d=n("./crc32"),p=n("./utf8"),v=n("./compressions"),y=n("./support");function _(o,m){this.options=o,this.loadOptions=m}_.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(o){var m,s;if(o.skip(22),this.fileNameLength=o.readInt(2),s=o.readInt(2),this.fileName=o.readData(this.fileNameLength),o.skip(s),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=function(h){for(var u in v)if(Object.prototype.hasOwnProperty.call(v,u)&&v[u].magic===h)return v[u];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,m,o.readData(this.compressedSize))},readCentralPart:function(o){this.versionMadeBy=o.readInt(2),o.skip(2),this.bitFlag=o.readInt(2),this.compressionMethod=o.readString(2),this.date=o.readDate(),this.crc32=o.readInt(4),this.compressedSize=o.readInt(4),this.uncompressedSize=o.readInt(4);var m=o.readInt(2);if(this.extraFieldsLength=o.readInt(2),this.fileCommentLength=o.readInt(2),this.diskNumberStart=o.readInt(2),this.internalFileAttributes=o.readInt(2),this.externalFileAttributes=o.readInt(4),this.localHeaderOffset=o.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");o.skip(m),this.readExtraFields(o),this.parseZIP64ExtraField(o),this.fileComment=o.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var o=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),o==0&&(this.dosPermissions=63&this.externalFileAttributes),o==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var o=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=o.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=o.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=o.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=o.readInt(4))}},readExtraFields:function(o){var m,s,h,u=o.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});o.index+4<u;)m=o.readInt(2),s=o.readInt(2),h=o.readData(s),this.extraFields[m]={id:m,length:s,value:h};o.setIndex(u)},handleUTF8:function(){var o=y.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=p.utf8decode(this.fileName),this.fileCommentStr=p.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var s=a.transformTo(o,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(s)}var h=this.findExtraFieldUnicodeComment();if(h!==null)this.fileCommentStr=h;else{var u=a.transformTo(o,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(u)}}},findExtraFieldUnicodePath:function(){var o=this.extraFields[28789];if(o){var m=i(o.value);return m.readInt(1)!==1||d(this.fileName)!==m.readInt(4)?null:p.utf8decode(m.readData(o.length-5))}return null},findExtraFieldUnicodeComment:function(){var o=this.extraFields[25461];if(o){var m=i(o.value);return m.readInt(1)!==1||d(this.fileComment)!==m.readInt(4)?null:p.utf8decode(m.readData(o.length-5))}return null}},A.exports=_},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,A,l){function i(m,s,h){this.name=m,this.dir=h.dir,this.date=h.date,this.comment=h.comment,this.unixPermissions=h.unixPermissions,this.dosPermissions=h.dosPermissions,this._data=s,this._dataBinary=h.binary,this.options={compression:h.compression,compressionOptions:h.compressionOptions}}var a=n("./stream/StreamHelper"),r=n("./stream/DataWorker"),d=n("./utf8"),p=n("./compressedObject"),v=n("./stream/GenericWorker");i.prototype={internalStream:function(m){var s=null,h="string";try{if(!m)throw new Error("No output type specified.");var u=(h=m.toLowerCase())==="string"||h==="text";h!=="binarystring"&&h!=="text"||(h="string"),s=this._decompressWorker();var g=!this._dataBinary;g&&!u&&(s=s.pipe(new d.Utf8EncodeWorker)),!g&&u&&(s=s.pipe(new d.Utf8DecodeWorker))}catch(S){(s=new v("error")).error(S)}return new a(s,h,"")},async:function(m,s){return this.internalStream(m).accumulate(s)},nodeStream:function(m,s){return this.internalStream(m||"nodebuffer").toNodejsStream(s)},_compressWorker:function(m,s){if(this._data instanceof p&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var h=this._decompressWorker();return this._dataBinary||(h=h.pipe(new d.Utf8EncodeWorker)),p.createWorkerFrom(h,m,s)},_decompressWorker:function(){return this._data instanceof p?this._data.getContentWorker():this._data instanceof v?this._data:new r(this._data)}};for(var y=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],_=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},o=0;o<y.length;o++)i.prototype[y[o]]=_;A.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,A,l){(function(i){var a,r,d=i.MutationObserver||i.WebKitMutationObserver;if(d){var p=0,v=new d(m),y=i.document.createTextNode("");v.observe(y,{characterData:!0}),a=function(){y.data=p=++p%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var s=i.document.createElement("script");s.onreadystatechange=function(){m(),s.onreadystatechange=null,s.parentNode.removeChild(s),s=null},i.document.documentElement.appendChild(s)}:function(){setTimeout(m,0)};else{var _=new i.MessageChannel;_.port1.onmessage=m,a=function(){_.port2.postMessage(0)}}var o=[];function m(){var s,h;r=!0;for(var u=o.length;u;){for(h=o,o=[],s=-1;++s<u;)h[s]();u=o.length}r=!1}A.exports=function(s){o.push(s)!==1||r||a()}}).call(this,typeof Ft<"u"?Ft:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,A,l){var i=n("immediate");function a(){}var r={},d=["REJECTED"],p=["FULFILLED"],v=["PENDING"];function y(u){if(typeof u!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,u!==a&&s(this,u)}function _(u,g,S){this.promise=u,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function o(u,g,S){i(function(){var C;try{C=g(S)}catch(D){return r.reject(u,D)}C===u?r.reject(u,new TypeError("Cannot resolve promise with itself")):r.resolve(u,C)})}function m(u){var g=u&&u.then;if(u&&(typeof u=="object"||typeof u=="function")&&typeof g=="function")return function(){g.apply(u,arguments)}}function s(u,g){var S=!1;function C(R){S||(S=!0,r.reject(u,R))}function D(R){S||(S=!0,r.resolve(u,R))}var P=h(function(){g(D,C)});P.status==="error"&&C(P.value)}function h(u,g){var S={};try{S.value=u(g),S.status="success"}catch(C){S.status="error",S.value=C}return S}(A.exports=y).prototype.finally=function(u){if(typeof u!="function")return this;var g=this.constructor;return this.then(function(S){return g.resolve(u()).then(function(){return S})},function(S){return g.resolve(u()).then(function(){throw S})})},y.prototype.catch=function(u){return this.then(null,u)},y.prototype.then=function(u,g){if(typeof u!="function"&&this.state===p||typeof g!="function"&&this.state===d)return this;var S=new this.constructor(a);return this.state!==v?o(S,this.state===p?u:g,this.outcome):this.queue.push(new _(S,u,g)),S},_.prototype.callFulfilled=function(u){r.resolve(this.promise,u)},_.prototype.otherCallFulfilled=function(u){o(this.promise,this.onFulfilled,u)},_.prototype.callRejected=function(u){r.reject(this.promise,u)},_.prototype.otherCallRejected=function(u){o(this.promise,this.onRejected,u)},r.resolve=function(u,g){var S=h(m,g);if(S.status==="error")return r.reject(u,S.value);var C=S.value;if(C)s(u,C);else{u.state=p,u.outcome=g;for(var D=-1,P=u.queue.length;++D<P;)u.queue[D].callFulfilled(g)}return u},r.reject=function(u,g){u.state=d,u.outcome=g;for(var S=-1,C=u.queue.length;++S<C;)u.queue[S].callRejected(g);return u},y.resolve=function(u){return u instanceof this?u:r.resolve(new this(a),u)},y.reject=function(u){var g=new this(a);return r.reject(g,u)},y.all=function(u){var g=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=u.length,C=!1;if(!S)return this.resolve([]);for(var D=new Array(S),P=0,R=-1,H=new this(a);++R<S;)B(u[R],R);return H;function B(G,tt){g.resolve(G).then(function(w){D[tt]=w,++P!==S||C||(C=!0,r.resolve(H,D))},function(w){C||(C=!0,r.reject(H,w))})}},y.race=function(u){var g=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=u.length,C=!1;if(!S)return this.resolve([]);for(var D=-1,P=new this(a);++D<S;)R=u[D],g.resolve(R).then(function(H){C||(C=!0,r.resolve(P,H))},function(H){C||(C=!0,r.reject(P,H))});var R;return P}},{immediate:36}],38:[function(n,A,l){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),A.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,A,l){var i=n("./zlib/deflate"),a=n("./utils/common"),r=n("./utils/strings"),d=n("./zlib/messages"),p=n("./zlib/zstream"),v=Object.prototype.toString,y=0,_=-1,o=0,m=8;function s(u){if(!(this instanceof s))return new s(u);this.options=a.assign({level:_,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:o,to:""},u||{});var g=this.options;g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(S!==y)throw new Error(d[S]);if(g.header&&i.deflateSetHeader(this.strm,g.header),g.dictionary){var C;if(C=typeof g.dictionary=="string"?r.string2buf(g.dictionary):v.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(S=i.deflateSetDictionary(this.strm,C))!==y)throw new Error(d[S]);this._dict_set=!0}}function h(u,g){var S=new s(g);if(S.push(u,!0),S.err)throw S.msg||d[S.err];return S.result}s.prototype.push=function(u,g){var S,C,D=this.strm,P=this.options.chunkSize;if(this.ended)return!1;C=g===~~g?g:g===!0?4:0,typeof u=="string"?D.input=r.string2buf(u):v.call(u)==="[object ArrayBuffer]"?D.input=new Uint8Array(u):D.input=u,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new a.Buf8(P),D.next_out=0,D.avail_out=P),(S=i.deflate(D,C))!==1&&S!==y)return this.onEnd(S),!(this.ended=!0);D.avail_out!==0&&(D.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(r.buf2binstring(a.shrinkBuf(D.output,D.next_out))):this.onData(a.shrinkBuf(D.output,D.next_out)))}while((0<D.avail_in||D.avail_out===0)&&S!==1);return C===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===y):C!==2||(this.onEnd(y),!(D.avail_out=0))},s.prototype.onData=function(u){this.chunks.push(u)},s.prototype.onEnd=function(u){u===y&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=u,this.msg=this.strm.msg},l.Deflate=s,l.deflate=h,l.deflateRaw=function(u,g){return(g=g||{}).raw=!0,h(u,g)},l.gzip=function(u,g){return(g=g||{}).gzip=!0,h(u,g)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,A,l){var i=n("./zlib/inflate"),a=n("./utils/common"),r=n("./utils/strings"),d=n("./zlib/constants"),p=n("./zlib/messages"),v=n("./zlib/zstream"),y=n("./zlib/gzheader"),_=Object.prototype.toString;function o(s){if(!(this instanceof o))return new o(s);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},s||{});var h=this.options;h.raw&&0<=h.windowBits&&h.windowBits<16&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),!(0<=h.windowBits&&h.windowBits<16)||s&&s.windowBits||(h.windowBits+=32),15<h.windowBits&&h.windowBits<48&&(15&h.windowBits)==0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var u=i.inflateInit2(this.strm,h.windowBits);if(u!==d.Z_OK)throw new Error(p[u]);this.header=new y,i.inflateGetHeader(this.strm,this.header)}function m(s,h){var u=new o(h);if(u.push(s,!0),u.err)throw u.msg||p[u.err];return u.result}o.prototype.push=function(s,h){var u,g,S,C,D,P,R=this.strm,H=this.options.chunkSize,B=this.options.dictionary,G=!1;if(this.ended)return!1;g=h===~~h?h:h===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof s=="string"?R.input=r.binstring2buf(s):_.call(s)==="[object ArrayBuffer]"?R.input=new Uint8Array(s):R.input=s,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new a.Buf8(H),R.next_out=0,R.avail_out=H),(u=i.inflate(R,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&B&&(P=typeof B=="string"?r.string2buf(B):_.call(B)==="[object ArrayBuffer]"?new Uint8Array(B):B,u=i.inflateSetDictionary(this.strm,P)),u===d.Z_BUF_ERROR&&G===!0&&(u=d.Z_OK,G=!1),u!==d.Z_STREAM_END&&u!==d.Z_OK)return this.onEnd(u),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&u!==d.Z_STREAM_END&&(R.avail_in!==0||g!==d.Z_FINISH&&g!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=r.utf8border(R.output,R.next_out),C=R.next_out-S,D=r.buf2string(R.output,S),R.next_out=C,R.avail_out=H-C,C&&a.arraySet(R.output,R.output,S,C,0),this.onData(D)):this.onData(a.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(G=!0)}while((0<R.avail_in||R.avail_out===0)&&u!==d.Z_STREAM_END);return u===d.Z_STREAM_END&&(g=d.Z_FINISH),g===d.Z_FINISH?(u=i.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===d.Z_OK):g!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(R.avail_out=0))},o.prototype.onData=function(s){this.chunks.push(s)},o.prototype.onEnd=function(s){s===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg},l.Inflate=o,l.inflate=m,l.inflateRaw=function(s,h){return(h=h||{}).raw=!0,m(s,h)},l.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,A,l){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";l.assign=function(d){for(var p=Array.prototype.slice.call(arguments,1);p.length;){var v=p.shift();if(v){if(typeof v!="object")throw new TypeError(v+"must be non-object");for(var y in v)v.hasOwnProperty(y)&&(d[y]=v[y])}}return d},l.shrinkBuf=function(d,p){return d.length===p?d:d.subarray?d.subarray(0,p):(d.length=p,d)};var a={arraySet:function(d,p,v,y,_){if(p.subarray&&d.subarray)d.set(p.subarray(v,v+y),_);else for(var o=0;o<y;o++)d[_+o]=p[v+o]},flattenChunks:function(d){var p,v,y,_,o,m;for(p=y=0,v=d.length;p<v;p++)y+=d[p].length;for(m=new Uint8Array(y),p=_=0,v=d.length;p<v;p++)o=d[p],m.set(o,_),_+=o.length;return m}},r={arraySet:function(d,p,v,y,_){for(var o=0;o<y;o++)d[_+o]=p[v+o]},flattenChunks:function(d){return[].concat.apply([],d)}};l.setTyped=function(d){d?(l.Buf8=Uint8Array,l.Buf16=Uint16Array,l.Buf32=Int32Array,l.assign(l,a)):(l.Buf8=Array,l.Buf16=Array,l.Buf32=Array,l.assign(l,r))},l.setTyped(i)},{}],42:[function(n,A,l){var i=n("./common"),a=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{r=!1}for(var d=new i.Buf8(256),p=0;p<256;p++)d[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;function v(y,_){if(_<65537&&(y.subarray&&r||!y.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(y,_));for(var o="",m=0;m<_;m++)o+=String.fromCharCode(y[m]);return o}d[254]=d[254]=1,l.string2buf=function(y){var _,o,m,s,h,u=y.length,g=0;for(s=0;s<u;s++)(64512&(o=y.charCodeAt(s)))==55296&&s+1<u&&(64512&(m=y.charCodeAt(s+1)))==56320&&(o=65536+(o-55296<<10)+(m-56320),s++),g+=o<128?1:o<2048?2:o<65536?3:4;for(_=new i.Buf8(g),s=h=0;h<g;s++)(64512&(o=y.charCodeAt(s)))==55296&&s+1<u&&(64512&(m=y.charCodeAt(s+1)))==56320&&(o=65536+(o-55296<<10)+(m-56320),s++),o<128?_[h++]=o:(o<2048?_[h++]=192|o>>>6:(o<65536?_[h++]=224|o>>>12:(_[h++]=240|o>>>18,_[h++]=128|o>>>12&63),_[h++]=128|o>>>6&63),_[h++]=128|63&o);return _},l.buf2binstring=function(y){return v(y,y.length)},l.binstring2buf=function(y){for(var _=new i.Buf8(y.length),o=0,m=_.length;o<m;o++)_[o]=y.charCodeAt(o);return _},l.buf2string=function(y,_){var o,m,s,h,u=_||y.length,g=new Array(2*u);for(o=m=0;o<u;)if((s=y[o++])<128)g[m++]=s;else if(4<(h=d[s]))g[m++]=65533,o+=h-1;else{for(s&=h===2?31:h===3?15:7;1<h&&o<u;)s=s<<6|63&y[o++],h--;1<h?g[m++]=65533:s<65536?g[m++]=s:(s-=65536,g[m++]=55296|s>>10&1023,g[m++]=56320|1023&s)}return v(g,m)},l.utf8border=function(y,_){var o;for((_=_||y.length)>y.length&&(_=y.length),o=_-1;0<=o&&(192&y[o])==128;)o--;return o<0||o===0?_:o+d[y[o]]>_?o:_}},{"./common":41}],43:[function(n,A,l){A.exports=function(i,a,r,d){for(var p=65535&i|0,v=i>>>16&65535|0,y=0;r!==0;){for(r-=y=2e3<r?2e3:r;v=v+(p=p+a[d++]|0)|0,--y;);p%=65521,v%=65521}return p|v<<16|0}},{}],44:[function(n,A,l){A.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,A,l){var i=function(){for(var a,r=[],d=0;d<256;d++){a=d;for(var p=0;p<8;p++)a=1&a?3988292384^a>>>1:a>>>1;r[d]=a}return r}();A.exports=function(a,r,d,p){var v=i,y=p+d;a^=-1;for(var _=p;_<y;_++)a=a>>>8^v[255&(a^r[_])];return-1^a}},{}],46:[function(n,A,l){var i,a=n("../utils/common"),r=n("./trees"),d=n("./adler32"),p=n("./crc32"),v=n("./messages"),y=0,_=4,o=0,m=-2,s=-1,h=4,u=2,g=8,S=9,C=286,D=30,P=19,R=2*C+1,H=15,B=3,G=258,tt=G+B+1,w=42,$=113,e=1,V=2,rt=3,L=4;function it(t,T){return t.msg=v[T],T}function Z(t){return(t<<1)-(4<t?9:0)}function et(t){for(var T=t.length;0<=--T;)t[T]=0}function O(t){var T=t.state,I=T.pending;I>t.avail_out&&(I=t.avail_out),I!==0&&(a.arraySet(t.output,T.pending_buf,T.pending_out,I,t.next_out),t.next_out+=I,T.pending_out+=I,t.total_out+=I,t.avail_out-=I,T.pending-=I,T.pending===0&&(T.pending_out=0))}function E(t,T){r._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,T),t.block_start=t.strstart,O(t.strm)}function Q(t,T){t.pending_buf[t.pending++]=T}function Y(t,T){t.pending_buf[t.pending++]=T>>>8&255,t.pending_buf[t.pending++]=255&T}function q(t,T){var I,f,c=t.max_chain_length,x=t.strstart,U=t.prev_length,N=t.nice_match,z=t.strstart>t.w_size-tt?t.strstart-(t.w_size-tt):0,M=t.window,X=t.w_mask,K=t.prev,J=t.strstart+G,ut=M[x+U-1],at=M[x+U];t.prev_length>=t.good_match&&(c>>=2),N>t.lookahead&&(N=t.lookahead);do if(M[(I=T)+U]===at&&M[I+U-1]===ut&&M[I]===M[x]&&M[++I]===M[x+1]){x+=2,I++;do;while(M[++x]===M[++I]&&M[++x]===M[++I]&&M[++x]===M[++I]&&M[++x]===M[++I]&&M[++x]===M[++I]&&M[++x]===M[++I]&&M[++x]===M[++I]&&M[++x]===M[++I]&&x<J);if(f=G-(J-x),x=J-G,U<f){if(t.match_start=T,N<=(U=f))break;ut=M[x+U-1],at=M[x+U]}}while((T=K[T&X])>z&&--c!=0);return U<=t.lookahead?U:t.lookahead}function ct(t){var T,I,f,c,x,U,N,z,M,X,K=t.w_size;do{if(c=t.window_size-t.lookahead-t.strstart,t.strstart>=K+(K-tt)){for(a.arraySet(t.window,t.window,K,K,0),t.match_start-=K,t.strstart-=K,t.block_start-=K,T=I=t.hash_size;f=t.head[--T],t.head[T]=K<=f?f-K:0,--I;);for(T=I=K;f=t.prev[--T],t.prev[T]=K<=f?f-K:0,--I;);c+=K}if(t.strm.avail_in===0)break;if(U=t.strm,N=t.window,z=t.strstart+t.lookahead,M=c,X=void 0,X=U.avail_in,M<X&&(X=M),I=X===0?0:(U.avail_in-=X,a.arraySet(N,U.input,U.next_in,X,z),U.state.wrap===1?U.adler=d(U.adler,N,X,z):U.state.wrap===2&&(U.adler=p(U.adler,N,X,z)),U.next_in+=X,U.total_in+=X,X),t.lookahead+=I,t.lookahead+t.insert>=B)for(x=t.strstart-t.insert,t.ins_h=t.window[x],t.ins_h=(t.ins_h<<t.hash_shift^t.window[x+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[x+B-1])&t.hash_mask,t.prev[x&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=x,x++,t.insert--,!(t.lookahead+t.insert<B)););}while(t.lookahead<tt&&t.strm.avail_in!==0)}function yt(t,T){for(var I,f;;){if(t.lookahead<tt){if(ct(t),t.lookahead<tt&&T===y)return e;if(t.lookahead===0)break}if(I=0,t.lookahead>=B&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+B-1])&t.hash_mask,I=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),I!==0&&t.strstart-I<=t.w_size-tt&&(t.match_length=q(t,I)),t.match_length>=B)if(f=r._tr_tally(t,t.strstart-t.match_start,t.match_length-B),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=B){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+B-1])&t.hash_mask,I=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,--t.match_length!=0;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else f=r._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(f&&(E(t,!1),t.strm.avail_out===0))return e}return t.insert=t.strstart<B-1?t.strstart:B-1,T===_?(E(t,!0),t.strm.avail_out===0?rt:L):t.last_lit&&(E(t,!1),t.strm.avail_out===0)?e:V}function st(t,T){for(var I,f,c;;){if(t.lookahead<tt){if(ct(t),t.lookahead<tt&&T===y)return e;if(t.lookahead===0)break}if(I=0,t.lookahead>=B&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+B-1])&t.hash_mask,I=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=B-1,I!==0&&t.prev_length<t.max_lazy_match&&t.strstart-I<=t.w_size-tt&&(t.match_length=q(t,I),t.match_length<=5&&(t.strategy===1||t.match_length===B&&4096<t.strstart-t.match_start)&&(t.match_length=B-1)),t.prev_length>=B&&t.match_length<=t.prev_length){for(c=t.strstart+t.lookahead-B,f=r._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-B),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=c&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+B-1])&t.hash_mask,I=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),--t.prev_length!=0;);if(t.match_available=0,t.match_length=B-1,t.strstart++,f&&(E(t,!1),t.strm.avail_out===0))return e}else if(t.match_available){if((f=r._tr_tally(t,0,t.window[t.strstart-1]))&&E(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return e}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(f=r._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<B-1?t.strstart:B-1,T===_?(E(t,!0),t.strm.avail_out===0?rt:L):t.last_lit&&(E(t,!1),t.strm.avail_out===0)?e:V}function ot(t,T,I,f,c){this.good_length=t,this.max_lazy=T,this.nice_length=I,this.max_chain=f,this.func=c}function mt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*R),this.dyn_dtree=new a.Buf16(2*(2*D+1)),this.bl_tree=new a.Buf16(2*(2*P+1)),et(this.dyn_ltree),et(this.dyn_dtree),et(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(H+1),this.heap=new a.Buf16(2*C+1),et(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*C+1),et(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ht(t){var T;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=u,(T=t.state).pending=0,T.pending_out=0,T.wrap<0&&(T.wrap=-T.wrap),T.status=T.wrap?w:$,t.adler=T.wrap===2?0:1,T.last_flush=y,r._tr_init(T),o):it(t,m)}function kt(t){var T=ht(t);return T===o&&function(I){I.window_size=2*I.w_size,et(I.head),I.max_lazy_match=i[I.level].max_lazy,I.good_match=i[I.level].good_length,I.nice_match=i[I.level].nice_length,I.max_chain_length=i[I.level].max_chain,I.strstart=0,I.block_start=0,I.lookahead=0,I.insert=0,I.match_length=I.prev_length=B-1,I.match_available=0,I.ins_h=0}(t.state),T}function wt(t,T,I,f,c,x){if(!t)return m;var U=1;if(T===s&&(T=6),f<0?(U=0,f=-f):15<f&&(U=2,f-=16),c<1||S<c||I!==g||f<8||15<f||T<0||9<T||x<0||h<x)return it(t,m);f===8&&(f=9);var N=new mt;return(t.state=N).strm=t,N.wrap=U,N.gzhead=null,N.w_bits=f,N.w_size=1<<N.w_bits,N.w_mask=N.w_size-1,N.hash_bits=c+7,N.hash_size=1<<N.hash_bits,N.hash_mask=N.hash_size-1,N.hash_shift=~~((N.hash_bits+B-1)/B),N.window=new a.Buf8(2*N.w_size),N.head=new a.Buf16(N.hash_size),N.prev=new a.Buf16(N.w_size),N.lit_bufsize=1<<c+6,N.pending_buf_size=4*N.lit_bufsize,N.pending_buf=new a.Buf8(N.pending_buf_size),N.d_buf=1*N.lit_bufsize,N.l_buf=3*N.lit_bufsize,N.level=T,N.strategy=x,N.method=I,kt(t)}i=[new ot(0,0,0,0,function(t,T){var I=65535;for(I>t.pending_buf_size-5&&(I=t.pending_buf_size-5);;){if(t.lookahead<=1){if(ct(t),t.lookahead===0&&T===y)return e;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var f=t.block_start+I;if((t.strstart===0||t.strstart>=f)&&(t.lookahead=t.strstart-f,t.strstart=f,E(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-tt&&(E(t,!1),t.strm.avail_out===0))return e}return t.insert=0,T===_?(E(t,!0),t.strm.avail_out===0?rt:L):(t.strstart>t.block_start&&(E(t,!1),t.strm.avail_out),e)}),new ot(4,4,8,4,yt),new ot(4,5,16,8,yt),new ot(4,6,32,32,yt),new ot(4,4,16,16,st),new ot(8,16,32,32,st),new ot(8,16,128,128,st),new ot(8,32,128,256,st),new ot(32,128,258,1024,st),new ot(32,258,258,4096,st)],l.deflateInit=function(t,T){return wt(t,T,g,15,8,0)},l.deflateInit2=wt,l.deflateReset=kt,l.deflateResetKeep=ht,l.deflateSetHeader=function(t,T){return t&&t.state?t.state.wrap!==2?m:(t.state.gzhead=T,o):m},l.deflate=function(t,T){var I,f,c,x;if(!t||!t.state||5<T||T<0)return t?it(t,m):m;if(f=t.state,!t.output||!t.input&&t.avail_in!==0||f.status===666&&T!==_)return it(t,t.avail_out===0?-5:m);if(f.strm=t,I=f.last_flush,f.last_flush=T,f.status===w)if(f.wrap===2)t.adler=0,Q(f,31),Q(f,139),Q(f,8),f.gzhead?(Q(f,(f.gzhead.text?1:0)+(f.gzhead.hcrc?2:0)+(f.gzhead.extra?4:0)+(f.gzhead.name?8:0)+(f.gzhead.comment?16:0)),Q(f,255&f.gzhead.time),Q(f,f.gzhead.time>>8&255),Q(f,f.gzhead.time>>16&255),Q(f,f.gzhead.time>>24&255),Q(f,f.level===9?2:2<=f.strategy||f.level<2?4:0),Q(f,255&f.gzhead.os),f.gzhead.extra&&f.gzhead.extra.length&&(Q(f,255&f.gzhead.extra.length),Q(f,f.gzhead.extra.length>>8&255)),f.gzhead.hcrc&&(t.adler=p(t.adler,f.pending_buf,f.pending,0)),f.gzindex=0,f.status=69):(Q(f,0),Q(f,0),Q(f,0),Q(f,0),Q(f,0),Q(f,f.level===9?2:2<=f.strategy||f.level<2?4:0),Q(f,3),f.status=$);else{var U=g+(f.w_bits-8<<4)<<8;U|=(2<=f.strategy||f.level<2?0:f.level<6?1:f.level===6?2:3)<<6,f.strstart!==0&&(U|=32),U+=31-U%31,f.status=$,Y(f,U),f.strstart!==0&&(Y(f,t.adler>>>16),Y(f,65535&t.adler)),t.adler=1}if(f.status===69)if(f.gzhead.extra){for(c=f.pending;f.gzindex<(65535&f.gzhead.extra.length)&&(f.pending!==f.pending_buf_size||(f.gzhead.hcrc&&f.pending>c&&(t.adler=p(t.adler,f.pending_buf,f.pending-c,c)),O(t),c=f.pending,f.pending!==f.pending_buf_size));)Q(f,255&f.gzhead.extra[f.gzindex]),f.gzindex++;f.gzhead.hcrc&&f.pending>c&&(t.adler=p(t.adler,f.pending_buf,f.pending-c,c)),f.gzindex===f.gzhead.extra.length&&(f.gzindex=0,f.status=73)}else f.status=73;if(f.status===73)if(f.gzhead.name){c=f.pending;do{if(f.pending===f.pending_buf_size&&(f.gzhead.hcrc&&f.pending>c&&(t.adler=p(t.adler,f.pending_buf,f.pending-c,c)),O(t),c=f.pending,f.pending===f.pending_buf_size)){x=1;break}x=f.gzindex<f.gzhead.name.length?255&f.gzhead.name.charCodeAt(f.gzindex++):0,Q(f,x)}while(x!==0);f.gzhead.hcrc&&f.pending>c&&(t.adler=p(t.adler,f.pending_buf,f.pending-c,c)),x===0&&(f.gzindex=0,f.status=91)}else f.status=91;if(f.status===91)if(f.gzhead.comment){c=f.pending;do{if(f.pending===f.pending_buf_size&&(f.gzhead.hcrc&&f.pending>c&&(t.adler=p(t.adler,f.pending_buf,f.pending-c,c)),O(t),c=f.pending,f.pending===f.pending_buf_size)){x=1;break}x=f.gzindex<f.gzhead.comment.length?255&f.gzhead.comment.charCodeAt(f.gzindex++):0,Q(f,x)}while(x!==0);f.gzhead.hcrc&&f.pending>c&&(t.adler=p(t.adler,f.pending_buf,f.pending-c,c)),x===0&&(f.status=103)}else f.status=103;if(f.status===103&&(f.gzhead.hcrc?(f.pending+2>f.pending_buf_size&&O(t),f.pending+2<=f.pending_buf_size&&(Q(f,255&t.adler),Q(f,t.adler>>8&255),t.adler=0,f.status=$)):f.status=$),f.pending!==0){if(O(t),t.avail_out===0)return f.last_flush=-1,o}else if(t.avail_in===0&&Z(T)<=Z(I)&&T!==_)return it(t,-5);if(f.status===666&&t.avail_in!==0)return it(t,-5);if(t.avail_in!==0||f.lookahead!==0||T!==y&&f.status!==666){var N=f.strategy===2?function(z,M){for(var X;;){if(z.lookahead===0&&(ct(z),z.lookahead===0)){if(M===y)return e;break}if(z.match_length=0,X=r._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,X&&(E(z,!1),z.strm.avail_out===0))return e}return z.insert=0,M===_?(E(z,!0),z.strm.avail_out===0?rt:L):z.last_lit&&(E(z,!1),z.strm.avail_out===0)?e:V}(f,T):f.strategy===3?function(z,M){for(var X,K,J,ut,at=z.window;;){if(z.lookahead<=G){if(ct(z),z.lookahead<=G&&M===y)return e;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=B&&0<z.strstart&&(K=at[J=z.strstart-1])===at[++J]&&K===at[++J]&&K===at[++J]){ut=z.strstart+G;do;while(K===at[++J]&&K===at[++J]&&K===at[++J]&&K===at[++J]&&K===at[++J]&&K===at[++J]&&K===at[++J]&&K===at[++J]&&J<ut);z.match_length=G-(ut-J),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=B?(X=r._tr_tally(z,1,z.match_length-B),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(X=r._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),X&&(E(z,!1),z.strm.avail_out===0))return e}return z.insert=0,M===_?(E(z,!0),z.strm.avail_out===0?rt:L):z.last_lit&&(E(z,!1),z.strm.avail_out===0)?e:V}(f,T):i[f.level].func(f,T);if(N!==rt&&N!==L||(f.status=666),N===e||N===rt)return t.avail_out===0&&(f.last_flush=-1),o;if(N===V&&(T===1?r._tr_align(f):T!==5&&(r._tr_stored_block(f,0,0,!1),T===3&&(et(f.head),f.lookahead===0&&(f.strstart=0,f.block_start=0,f.insert=0))),O(t),t.avail_out===0))return f.last_flush=-1,o}return T!==_?o:f.wrap<=0?1:(f.wrap===2?(Q(f,255&t.adler),Q(f,t.adler>>8&255),Q(f,t.adler>>16&255),Q(f,t.adler>>24&255),Q(f,255&t.total_in),Q(f,t.total_in>>8&255),Q(f,t.total_in>>16&255),Q(f,t.total_in>>24&255)):(Y(f,t.adler>>>16),Y(f,65535&t.adler)),O(t),0<f.wrap&&(f.wrap=-f.wrap),f.pending!==0?o:1)},l.deflateEnd=function(t){var T;return t&&t.state?(T=t.state.status)!==w&&T!==69&&T!==73&&T!==91&&T!==103&&T!==$&&T!==666?it(t,m):(t.state=null,T===$?it(t,-3):o):m},l.deflateSetDictionary=function(t,T){var I,f,c,x,U,N,z,M,X=T.length;if(!t||!t.state||(x=(I=t.state).wrap)===2||x===1&&I.status!==w||I.lookahead)return m;for(x===1&&(t.adler=d(t.adler,T,X,0)),I.wrap=0,X>=I.w_size&&(x===0&&(et(I.head),I.strstart=0,I.block_start=0,I.insert=0),M=new a.Buf8(I.w_size),a.arraySet(M,T,X-I.w_size,I.w_size,0),T=M,X=I.w_size),U=t.avail_in,N=t.next_in,z=t.input,t.avail_in=X,t.next_in=0,t.input=T,ct(I);I.lookahead>=B;){for(f=I.strstart,c=I.lookahead-(B-1);I.ins_h=(I.ins_h<<I.hash_shift^I.window[f+B-1])&I.hash_mask,I.prev[f&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=f,f++,--c;);I.strstart=f,I.lookahead=B-1,ct(I)}return I.strstart+=I.lookahead,I.block_start=I.strstart,I.insert=I.lookahead,I.lookahead=0,I.match_length=I.prev_length=B-1,I.match_available=0,t.next_in=N,t.input=z,t.avail_in=U,I.wrap=x,o},l.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,A,l){A.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,A,l){A.exports=function(i,a){var r,d,p,v,y,_,o,m,s,h,u,g,S,C,D,P,R,H,B,G,tt,w,$,e,V;r=i.state,d=i.next_in,e=i.input,p=d+(i.avail_in-5),v=i.next_out,V=i.output,y=v-(a-i.avail_out),_=v+(i.avail_out-257),o=r.dmax,m=r.wsize,s=r.whave,h=r.wnext,u=r.window,g=r.hold,S=r.bits,C=r.lencode,D=r.distcode,P=(1<<r.lenbits)-1,R=(1<<r.distbits)-1;t:do{S<15&&(g+=e[d++]<<S,S+=8,g+=e[d++]<<S,S+=8),H=C[g&P];e:for(;;){if(g>>>=B=H>>>24,S-=B,(B=H>>>16&255)===0)V[v++]=65535&H;else{if(!(16&B)){if((64&B)==0){H=C[(65535&H)+(g&(1<<B)-1)];continue e}if(32&B){r.mode=12;break t}i.msg="invalid literal/length code",r.mode=30;break t}G=65535&H,(B&=15)&&(S<B&&(g+=e[d++]<<S,S+=8),G+=g&(1<<B)-1,g>>>=B,S-=B),S<15&&(g+=e[d++]<<S,S+=8,g+=e[d++]<<S,S+=8),H=D[g&R];r:for(;;){if(g>>>=B=H>>>24,S-=B,!(16&(B=H>>>16&255))){if((64&B)==0){H=D[(65535&H)+(g&(1<<B)-1)];continue r}i.msg="invalid distance code",r.mode=30;break t}if(tt=65535&H,S<(B&=15)&&(g+=e[d++]<<S,(S+=8)<B&&(g+=e[d++]<<S,S+=8)),o<(tt+=g&(1<<B)-1)){i.msg="invalid distance too far back",r.mode=30;break t}if(g>>>=B,S-=B,(B=v-y)<tt){if(s<(B=tt-B)&&r.sane){i.msg="invalid distance too far back",r.mode=30;break t}if($=u,(w=0)===h){if(w+=m-B,B<G){for(G-=B;V[v++]=u[w++],--B;);w=v-tt,$=V}}else if(h<B){if(w+=m+h-B,(B-=h)<G){for(G-=B;V[v++]=u[w++],--B;);if(w=0,h<G){for(G-=B=h;V[v++]=u[w++],--B;);w=v-tt,$=V}}}else if(w+=h-B,B<G){for(G-=B;V[v++]=u[w++],--B;);w=v-tt,$=V}for(;2<G;)V[v++]=$[w++],V[v++]=$[w++],V[v++]=$[w++],G-=3;G&&(V[v++]=$[w++],1<G&&(V[v++]=$[w++]))}else{for(w=v-tt;V[v++]=V[w++],V[v++]=V[w++],V[v++]=V[w++],2<(G-=3););G&&(V[v++]=V[w++],1<G&&(V[v++]=V[w++]))}break}}break}}while(d<p&&v<_);d-=G=S>>3,g&=(1<<(S-=G<<3))-1,i.next_in=d,i.next_out=v,i.avail_in=d<p?p-d+5:5-(d-p),i.avail_out=v<_?_-v+257:257-(v-_),r.hold=g,r.bits=S}},{}],49:[function(n,A,l){var i=n("../utils/common"),a=n("./adler32"),r=n("./crc32"),d=n("./inffast"),p=n("./inftrees"),v=1,y=2,_=0,o=-2,m=1,s=852,h=592;function u(w){return(w>>>24&255)+(w>>>8&65280)+((65280&w)<<8)+((255&w)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(w){var $;return w&&w.state?($=w.state,w.total_in=w.total_out=$.total=0,w.msg="",$.wrap&&(w.adler=1&$.wrap),$.mode=m,$.last=0,$.havedict=0,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new i.Buf32(s),$.distcode=$.distdyn=new i.Buf32(h),$.sane=1,$.back=-1,_):o}function C(w){var $;return w&&w.state?(($=w.state).wsize=0,$.whave=0,$.wnext=0,S(w)):o}function D(w,$){var e,V;return w&&w.state?(V=w.state,$<0?(e=0,$=-$):(e=1+($>>4),$<48&&($&=15)),$&&($<8||15<$)?o:(V.window!==null&&V.wbits!==$&&(V.window=null),V.wrap=e,V.wbits=$,C(w))):o}function P(w,$){var e,V;return w?(V=new g,(w.state=V).window=null,(e=D(w,$))!==_&&(w.state=null),e):o}var R,H,B=!0;function G(w){if(B){var $;for(R=new i.Buf32(512),H=new i.Buf32(32),$=0;$<144;)w.lens[$++]=8;for(;$<256;)w.lens[$++]=9;for(;$<280;)w.lens[$++]=7;for(;$<288;)w.lens[$++]=8;for(p(v,w.lens,0,288,R,0,w.work,{bits:9}),$=0;$<32;)w.lens[$++]=5;p(y,w.lens,0,32,H,0,w.work,{bits:5}),B=!1}w.lencode=R,w.lenbits=9,w.distcode=H,w.distbits=5}function tt(w,$,e,V){var rt,L=w.state;return L.window===null&&(L.wsize=1<<L.wbits,L.wnext=0,L.whave=0,L.window=new i.Buf8(L.wsize)),V>=L.wsize?(i.arraySet(L.window,$,e-L.wsize,L.wsize,0),L.wnext=0,L.whave=L.wsize):(V<(rt=L.wsize-L.wnext)&&(rt=V),i.arraySet(L.window,$,e-V,rt,L.wnext),(V-=rt)?(i.arraySet(L.window,$,e-V,V,0),L.wnext=V,L.whave=L.wsize):(L.wnext+=rt,L.wnext===L.wsize&&(L.wnext=0),L.whave<L.wsize&&(L.whave+=rt))),0}l.inflateReset=C,l.inflateReset2=D,l.inflateResetKeep=S,l.inflateInit=function(w){return P(w,15)},l.inflateInit2=P,l.inflate=function(w,$){var e,V,rt,L,it,Z,et,O,E,Q,Y,q,ct,yt,st,ot,mt,ht,kt,wt,t,T,I,f,c=0,x=new i.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!w||!w.state||!w.output||!w.input&&w.avail_in!==0)return o;(e=w.state).mode===12&&(e.mode=13),it=w.next_out,rt=w.output,et=w.avail_out,L=w.next_in,V=w.input,Z=w.avail_in,O=e.hold,E=e.bits,Q=Z,Y=et,T=_;t:for(;;)switch(e.mode){case m:if(e.wrap===0){e.mode=13;break}for(;E<16;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}if(2&e.wrap&&O===35615){x[e.check=0]=255&O,x[1]=O>>>8&255,e.check=r(e.check,x,2,0),E=O=0,e.mode=2;break}if(e.flags=0,e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&O)<<8)+(O>>8))%31){w.msg="incorrect header check",e.mode=30;break}if((15&O)!=8){w.msg="unknown compression method",e.mode=30;break}if(E-=4,t=8+(15&(O>>>=4)),e.wbits===0)e.wbits=t;else if(t>e.wbits){w.msg="invalid window size",e.mode=30;break}e.dmax=1<<t,w.adler=e.check=1,e.mode=512&O?10:12,E=O=0;break;case 2:for(;E<16;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}if(e.flags=O,(255&e.flags)!=8){w.msg="unknown compression method",e.mode=30;break}if(57344&e.flags){w.msg="unknown header flags set",e.mode=30;break}e.head&&(e.head.text=O>>8&1),512&e.flags&&(x[0]=255&O,x[1]=O>>>8&255,e.check=r(e.check,x,2,0)),E=O=0,e.mode=3;case 3:for(;E<32;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}e.head&&(e.head.time=O),512&e.flags&&(x[0]=255&O,x[1]=O>>>8&255,x[2]=O>>>16&255,x[3]=O>>>24&255,e.check=r(e.check,x,4,0)),E=O=0,e.mode=4;case 4:for(;E<16;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}e.head&&(e.head.xflags=255&O,e.head.os=O>>8),512&e.flags&&(x[0]=255&O,x[1]=O>>>8&255,e.check=r(e.check,x,2,0)),E=O=0,e.mode=5;case 5:if(1024&e.flags){for(;E<16;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}e.length=O,e.head&&(e.head.extra_len=O),512&e.flags&&(x[0]=255&O,x[1]=O>>>8&255,e.check=r(e.check,x,2,0)),E=O=0}else e.head&&(e.head.extra=null);e.mode=6;case 6:if(1024&e.flags&&(Z<(q=e.length)&&(q=Z),q&&(e.head&&(t=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Array(e.head.extra_len)),i.arraySet(e.head.extra,V,L,q,t)),512&e.flags&&(e.check=r(e.check,V,q,L)),Z-=q,L+=q,e.length-=q),e.length))break t;e.length=0,e.mode=7;case 7:if(2048&e.flags){if(Z===0)break t;for(q=0;t=V[L+q++],e.head&&t&&e.length<65536&&(e.head.name+=String.fromCharCode(t)),t&&q<Z;);if(512&e.flags&&(e.check=r(e.check,V,q,L)),Z-=q,L+=q,t)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=8;case 8:if(4096&e.flags){if(Z===0)break t;for(q=0;t=V[L+q++],e.head&&t&&e.length<65536&&(e.head.comment+=String.fromCharCode(t)),t&&q<Z;);if(512&e.flags&&(e.check=r(e.check,V,q,L)),Z-=q,L+=q,t)break t}else e.head&&(e.head.comment=null);e.mode=9;case 9:if(512&e.flags){for(;E<16;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}if(O!==(65535&e.check)){w.msg="header crc mismatch",e.mode=30;break}E=O=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),w.adler=e.check=0,e.mode=12;break;case 10:for(;E<32;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}w.adler=e.check=u(O),E=O=0,e.mode=11;case 11:if(e.havedict===0)return w.next_out=it,w.avail_out=et,w.next_in=L,w.avail_in=Z,e.hold=O,e.bits=E,2;w.adler=e.check=1,e.mode=12;case 12:if($===5||$===6)break t;case 13:if(e.last){O>>>=7&E,E-=7&E,e.mode=27;break}for(;E<3;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}switch(e.last=1&O,E-=1,3&(O>>>=1)){case 0:e.mode=14;break;case 1:if(G(e),e.mode=20,$!==6)break;O>>>=2,E-=2;break t;case 2:e.mode=17;break;case 3:w.msg="invalid block type",e.mode=30}O>>>=2,E-=2;break;case 14:for(O>>>=7&E,E-=7&E;E<32;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}if((65535&O)!=(O>>>16^65535)){w.msg="invalid stored block lengths",e.mode=30;break}if(e.length=65535&O,E=O=0,e.mode=15,$===6)break t;case 15:e.mode=16;case 16:if(q=e.length){if(Z<q&&(q=Z),et<q&&(q=et),q===0)break t;i.arraySet(rt,V,L,q,it),Z-=q,L+=q,et-=q,it+=q,e.length-=q;break}e.mode=12;break;case 17:for(;E<14;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}if(e.nlen=257+(31&O),O>>>=5,E-=5,e.ndist=1+(31&O),O>>>=5,E-=5,e.ncode=4+(15&O),O>>>=4,E-=4,286<e.nlen||30<e.ndist){w.msg="too many length or distance symbols",e.mode=30;break}e.have=0,e.mode=18;case 18:for(;e.have<e.ncode;){for(;E<3;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}e.lens[U[e.have++]]=7&O,O>>>=3,E-=3}for(;e.have<19;)e.lens[U[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,I={bits:e.lenbits},T=p(0,e.lens,0,19,e.lencode,0,e.work,I),e.lenbits=I.bits,T){w.msg="invalid code lengths set",e.mode=30;break}e.have=0,e.mode=19;case 19:for(;e.have<e.nlen+e.ndist;){for(;ot=(c=e.lencode[O&(1<<e.lenbits)-1])>>>16&255,mt=65535&c,!((st=c>>>24)<=E);){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}if(mt<16)O>>>=st,E-=st,e.lens[e.have++]=mt;else{if(mt===16){for(f=st+2;E<f;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}if(O>>>=st,E-=st,e.have===0){w.msg="invalid bit length repeat",e.mode=30;break}t=e.lens[e.have-1],q=3+(3&O),O>>>=2,E-=2}else if(mt===17){for(f=st+3;E<f;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}E-=st,t=0,q=3+(7&(O>>>=st)),O>>>=3,E-=3}else{for(f=st+7;E<f;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}E-=st,t=0,q=11+(127&(O>>>=st)),O>>>=7,E-=7}if(e.have+q>e.nlen+e.ndist){w.msg="invalid bit length repeat",e.mode=30;break}for(;q--;)e.lens[e.have++]=t}}if(e.mode===30)break;if(e.lens[256]===0){w.msg="invalid code -- missing end-of-block",e.mode=30;break}if(e.lenbits=9,I={bits:e.lenbits},T=p(v,e.lens,0,e.nlen,e.lencode,0,e.work,I),e.lenbits=I.bits,T){w.msg="invalid literal/lengths set",e.mode=30;break}if(e.distbits=6,e.distcode=e.distdyn,I={bits:e.distbits},T=p(y,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,I),e.distbits=I.bits,T){w.msg="invalid distances set",e.mode=30;break}if(e.mode=20,$===6)break t;case 20:e.mode=21;case 21:if(6<=Z&&258<=et){w.next_out=it,w.avail_out=et,w.next_in=L,w.avail_in=Z,e.hold=O,e.bits=E,d(w,Y),it=w.next_out,rt=w.output,et=w.avail_out,L=w.next_in,V=w.input,Z=w.avail_in,O=e.hold,E=e.bits,e.mode===12&&(e.back=-1);break}for(e.back=0;ot=(c=e.lencode[O&(1<<e.lenbits)-1])>>>16&255,mt=65535&c,!((st=c>>>24)<=E);){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}if(ot&&(240&ot)==0){for(ht=st,kt=ot,wt=mt;ot=(c=e.lencode[wt+((O&(1<<ht+kt)-1)>>ht)])>>>16&255,mt=65535&c,!(ht+(st=c>>>24)<=E);){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}O>>>=ht,E-=ht,e.back+=ht}if(O>>>=st,E-=st,e.back+=st,e.length=mt,ot===0){e.mode=26;break}if(32&ot){e.back=-1,e.mode=12;break}if(64&ot){w.msg="invalid literal/length code",e.mode=30;break}e.extra=15&ot,e.mode=22;case 22:if(e.extra){for(f=e.extra;E<f;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}e.length+=O&(1<<e.extra)-1,O>>>=e.extra,E-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=23;case 23:for(;ot=(c=e.distcode[O&(1<<e.distbits)-1])>>>16&255,mt=65535&c,!((st=c>>>24)<=E);){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}if((240&ot)==0){for(ht=st,kt=ot,wt=mt;ot=(c=e.distcode[wt+((O&(1<<ht+kt)-1)>>ht)])>>>16&255,mt=65535&c,!(ht+(st=c>>>24)<=E);){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}O>>>=ht,E-=ht,e.back+=ht}if(O>>>=st,E-=st,e.back+=st,64&ot){w.msg="invalid distance code",e.mode=30;break}e.offset=mt,e.extra=15&ot,e.mode=24;case 24:if(e.extra){for(f=e.extra;E<f;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}e.offset+=O&(1<<e.extra)-1,O>>>=e.extra,E-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){w.msg="invalid distance too far back",e.mode=30;break}e.mode=25;case 25:if(et===0)break t;if(q=Y-et,e.offset>q){if((q=e.offset-q)>e.whave&&e.sane){w.msg="invalid distance too far back",e.mode=30;break}ct=q>e.wnext?(q-=e.wnext,e.wsize-q):e.wnext-q,q>e.length&&(q=e.length),yt=e.window}else yt=rt,ct=it-e.offset,q=e.length;for(et<q&&(q=et),et-=q,e.length-=q;rt[it++]=yt[ct++],--q;);e.length===0&&(e.mode=21);break;case 26:if(et===0)break t;rt[it++]=e.length,et--,e.mode=21;break;case 27:if(e.wrap){for(;E<32;){if(Z===0)break t;Z--,O|=V[L++]<<E,E+=8}if(Y-=et,w.total_out+=Y,e.total+=Y,Y&&(w.adler=e.check=e.flags?r(e.check,rt,Y,it-Y):a(e.check,rt,Y,it-Y)),Y=et,(e.flags?O:u(O))!==e.check){w.msg="incorrect data check",e.mode=30;break}E=O=0}e.mode=28;case 28:if(e.wrap&&e.flags){for(;E<32;){if(Z===0)break t;Z--,O+=V[L++]<<E,E+=8}if(O!==(4294967295&e.total)){w.msg="incorrect length check",e.mode=30;break}E=O=0}e.mode=29;case 29:T=1;break t;case 30:T=-3;break t;case 31:return-4;case 32:default:return o}return w.next_out=it,w.avail_out=et,w.next_in=L,w.avail_in=Z,e.hold=O,e.bits=E,(e.wsize||Y!==w.avail_out&&e.mode<30&&(e.mode<27||$!==4))&&tt(w,w.output,w.next_out,Y-w.avail_out)?(e.mode=31,-4):(Q-=w.avail_in,Y-=w.avail_out,w.total_in+=Q,w.total_out+=Y,e.total+=Y,e.wrap&&Y&&(w.adler=e.check=e.flags?r(e.check,rt,Y,w.next_out-Y):a(e.check,rt,Y,w.next_out-Y)),w.data_type=e.bits+(e.last?64:0)+(e.mode===12?128:0)+(e.mode===20||e.mode===15?256:0),(Q==0&&Y===0||$===4)&&T===_&&(T=-5),T)},l.inflateEnd=function(w){if(!w||!w.state)return o;var $=w.state;return $.window&&($.window=null),w.state=null,_},l.inflateGetHeader=function(w,$){var e;return w&&w.state?(2&(e=w.state).wrap)==0?o:((e.head=$).done=!1,_):o},l.inflateSetDictionary=function(w,$){var e,V=$.length;return w&&w.state?(e=w.state).wrap!==0&&e.mode!==11?o:e.mode===11&&a(1,$,V,0)!==e.check?-3:tt(w,$,V,V)?(e.mode=31,-4):(e.havedict=1,_):o},l.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,A,l){var i=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];A.exports=function(v,y,_,o,m,s,h,u){var g,S,C,D,P,R,H,B,G,tt=u.bits,w=0,$=0,e=0,V=0,rt=0,L=0,it=0,Z=0,et=0,O=0,E=null,Q=0,Y=new i.Buf16(16),q=new i.Buf16(16),ct=null,yt=0;for(w=0;w<=15;w++)Y[w]=0;for($=0;$<o;$++)Y[y[_+$]]++;for(rt=tt,V=15;1<=V&&Y[V]===0;V--);if(V<rt&&(rt=V),V===0)return m[s++]=20971520,m[s++]=20971520,u.bits=1,0;for(e=1;e<V&&Y[e]===0;e++);for(rt<e&&(rt=e),w=Z=1;w<=15;w++)if(Z<<=1,(Z-=Y[w])<0)return-1;if(0<Z&&(v===0||V!==1))return-1;for(q[1]=0,w=1;w<15;w++)q[w+1]=q[w]+Y[w];for($=0;$<o;$++)y[_+$]!==0&&(h[q[y[_+$]]++]=$);if(R=v===0?(E=ct=h,19):v===1?(E=a,Q-=257,ct=r,yt-=257,256):(E=d,ct=p,-1),w=e,P=s,it=$=O=0,C=-1,D=(et=1<<(L=rt))-1,v===1&&852<et||v===2&&592<et)return 1;for(;;){for(H=w-it,G=h[$]<R?(B=0,h[$]):h[$]>R?(B=ct[yt+h[$]],E[Q+h[$]]):(B=96,0),g=1<<w-it,e=S=1<<L;m[P+(O>>it)+(S-=g)]=H<<24|B<<16|G|0,S!==0;);for(g=1<<w-1;O&g;)g>>=1;if(g!==0?(O&=g-1,O+=g):O=0,$++,--Y[w]==0){if(w===V)break;w=y[_+h[$]]}if(rt<w&&(O&D)!==C){for(it===0&&(it=rt),P+=e,Z=1<<(L=w-it);L+it<V&&!((Z-=Y[L+it])<=0);)L++,Z<<=1;if(et+=1<<L,v===1&&852<et||v===2&&592<et)return 1;m[C=O&D]=rt<<24|L<<16|P-s|0}}return O!==0&&(m[P+O]=w-it<<24|64<<16|0),u.bits=rt,0}},{"../utils/common":41}],51:[function(n,A,l){A.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,A,l){var i=n("../utils/common"),a=0,r=1;function d(c){for(var x=c.length;0<=--x;)c[x]=0}var p=0,v=29,y=256,_=y+1+v,o=30,m=19,s=2*_+1,h=15,u=16,g=7,S=256,C=16,D=17,P=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],H=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],tt=new Array(2*(_+2));d(tt);var w=new Array(2*o);d(w);var $=new Array(512);d($);var e=new Array(256);d(e);var V=new Array(v);d(V);var rt,L,it,Z=new Array(o);function et(c,x,U,N,z){this.static_tree=c,this.extra_bits=x,this.extra_base=U,this.elems=N,this.max_length=z,this.has_stree=c&&c.length}function O(c,x){this.dyn_tree=c,this.max_code=0,this.stat_desc=x}function E(c){return c<256?$[c]:$[256+(c>>>7)]}function Q(c,x){c.pending_buf[c.pending++]=255&x,c.pending_buf[c.pending++]=x>>>8&255}function Y(c,x,U){c.bi_valid>u-U?(c.bi_buf|=x<<c.bi_valid&65535,Q(c,c.bi_buf),c.bi_buf=x>>u-c.bi_valid,c.bi_valid+=U-u):(c.bi_buf|=x<<c.bi_valid&65535,c.bi_valid+=U)}function q(c,x,U){Y(c,U[2*x],U[2*x+1])}function ct(c,x){for(var U=0;U|=1&c,c>>>=1,U<<=1,0<--x;);return U>>>1}function yt(c,x,U){var N,z,M=new Array(h+1),X=0;for(N=1;N<=h;N++)M[N]=X=X+U[N-1]<<1;for(z=0;z<=x;z++){var K=c[2*z+1];K!==0&&(c[2*z]=ct(M[K]++,K))}}function st(c){var x;for(x=0;x<_;x++)c.dyn_ltree[2*x]=0;for(x=0;x<o;x++)c.dyn_dtree[2*x]=0;for(x=0;x<m;x++)c.bl_tree[2*x]=0;c.dyn_ltree[2*S]=1,c.opt_len=c.static_len=0,c.last_lit=c.matches=0}function ot(c){8<c.bi_valid?Q(c,c.bi_buf):0<c.bi_valid&&(c.pending_buf[c.pending++]=c.bi_buf),c.bi_buf=0,c.bi_valid=0}function mt(c,x,U,N){var z=2*x,M=2*U;return c[z]<c[M]||c[z]===c[M]&&N[x]<=N[U]}function ht(c,x,U){for(var N=c.heap[U],z=U<<1;z<=c.heap_len&&(z<c.heap_len&&mt(x,c.heap[z+1],c.heap[z],c.depth)&&z++,!mt(x,N,c.heap[z],c.depth));)c.heap[U]=c.heap[z],U=z,z<<=1;c.heap[U]=N}function kt(c,x,U){var N,z,M,X,K=0;if(c.last_lit!==0)for(;N=c.pending_buf[c.d_buf+2*K]<<8|c.pending_buf[c.d_buf+2*K+1],z=c.pending_buf[c.l_buf+K],K++,N===0?q(c,z,x):(q(c,(M=e[z])+y+1,x),(X=R[M])!==0&&Y(c,z-=V[M],X),q(c,M=E(--N),U),(X=H[M])!==0&&Y(c,N-=Z[M],X)),K<c.last_lit;);q(c,S,x)}function wt(c,x){var U,N,z,M=x.dyn_tree,X=x.stat_desc.static_tree,K=x.stat_desc.has_stree,J=x.stat_desc.elems,ut=-1;for(c.heap_len=0,c.heap_max=s,U=0;U<J;U++)M[2*U]!==0?(c.heap[++c.heap_len]=ut=U,c.depth[U]=0):M[2*U+1]=0;for(;c.heap_len<2;)M[2*(z=c.heap[++c.heap_len]=ut<2?++ut:0)]=1,c.depth[z]=0,c.opt_len--,K&&(c.static_len-=X[2*z+1]);for(x.max_code=ut,U=c.heap_len>>1;1<=U;U--)ht(c,M,U);for(z=J;U=c.heap[1],c.heap[1]=c.heap[c.heap_len--],ht(c,M,1),N=c.heap[1],c.heap[--c.heap_max]=U,c.heap[--c.heap_max]=N,M[2*z]=M[2*U]+M[2*N],c.depth[z]=(c.depth[U]>=c.depth[N]?c.depth[U]:c.depth[N])+1,M[2*U+1]=M[2*N+1]=z,c.heap[1]=z++,ht(c,M,1),2<=c.heap_len;);c.heap[--c.heap_max]=c.heap[1],function(at,vt){var zt,St,At,ft,Ot,Vt,Ct=vt.dyn_tree,Lt=vt.max_code,Gt=vt.stat_desc.static_tree,qt=vt.stat_desc.has_stree,Yt=vt.stat_desc.extra_bits,jt=vt.stat_desc.extra_base,Et=vt.stat_desc.max_length,It=0;for(ft=0;ft<=h;ft++)at.bl_count[ft]=0;for(Ct[2*at.heap[at.heap_max]+1]=0,zt=at.heap_max+1;zt<s;zt++)Et<(ft=Ct[2*Ct[2*(St=at.heap[zt])+1]+1]+1)&&(ft=Et,It++),Ct[2*St+1]=ft,Lt<St||(at.bl_count[ft]++,Ot=0,jt<=St&&(Ot=Yt[St-jt]),Vt=Ct[2*St],at.opt_len+=Vt*(ft+Ot),qt&&(at.static_len+=Vt*(Gt[2*St+1]+Ot)));if(It!==0){do{for(ft=Et-1;at.bl_count[ft]===0;)ft--;at.bl_count[ft]--,at.bl_count[ft+1]+=2,at.bl_count[Et]--,It-=2}while(0<It);for(ft=Et;ft!==0;ft--)for(St=at.bl_count[ft];St!==0;)Lt<(At=at.heap[--zt])||(Ct[2*At+1]!==ft&&(at.opt_len+=(ft-Ct[2*At+1])*Ct[2*At],Ct[2*At+1]=ft),St--)}}(c,x),yt(M,ut,c.bl_count)}function t(c,x,U){var N,z,M=-1,X=x[1],K=0,J=7,ut=4;for(X===0&&(J=138,ut=3),x[2*(U+1)+1]=65535,N=0;N<=U;N++)z=X,X=x[2*(N+1)+1],++K<J&&z===X||(K<ut?c.bl_tree[2*z]+=K:z!==0?(z!==M&&c.bl_tree[2*z]++,c.bl_tree[2*C]++):K<=10?c.bl_tree[2*D]++:c.bl_tree[2*P]++,M=z,ut=(K=0)===X?(J=138,3):z===X?(J=6,3):(J=7,4))}function T(c,x,U){var N,z,M=-1,X=x[1],K=0,J=7,ut=4;for(X===0&&(J=138,ut=3),N=0;N<=U;N++)if(z=X,X=x[2*(N+1)+1],!(++K<J&&z===X)){if(K<ut)for(;q(c,z,c.bl_tree),--K!=0;);else z!==0?(z!==M&&(q(c,z,c.bl_tree),K--),q(c,C,c.bl_tree),Y(c,K-3,2)):K<=10?(q(c,D,c.bl_tree),Y(c,K-3,3)):(q(c,P,c.bl_tree),Y(c,K-11,7));M=z,ut=(K=0)===X?(J=138,3):z===X?(J=6,3):(J=7,4)}}d(Z);var I=!1;function f(c,x,U,N){Y(c,(p<<1)+(N?1:0),3),function(z,M,X,K){ot(z),K&&(Q(z,X),Q(z,~X)),i.arraySet(z.pending_buf,z.window,M,X,z.pending),z.pending+=X}(c,x,U,!0)}l._tr_init=function(c){I||(function(){var x,U,N,z,M,X=new Array(h+1);for(z=N=0;z<v-1;z++)for(V[z]=N,x=0;x<1<<R[z];x++)e[N++]=z;for(e[N-1]=z,z=M=0;z<16;z++)for(Z[z]=M,x=0;x<1<<H[z];x++)$[M++]=z;for(M>>=7;z<o;z++)for(Z[z]=M<<7,x=0;x<1<<H[z]-7;x++)$[256+M++]=z;for(U=0;U<=h;U++)X[U]=0;for(x=0;x<=143;)tt[2*x+1]=8,x++,X[8]++;for(;x<=255;)tt[2*x+1]=9,x++,X[9]++;for(;x<=279;)tt[2*x+1]=7,x++,X[7]++;for(;x<=287;)tt[2*x+1]=8,x++,X[8]++;for(yt(tt,_+1,X),x=0;x<o;x++)w[2*x+1]=5,w[2*x]=ct(x,5);rt=new et(tt,R,y+1,_,h),L=new et(w,H,0,o,h),it=new et(new Array(0),B,0,m,g)}(),I=!0),c.l_desc=new O(c.dyn_ltree,rt),c.d_desc=new O(c.dyn_dtree,L),c.bl_desc=new O(c.bl_tree,it),c.bi_buf=0,c.bi_valid=0,st(c)},l._tr_stored_block=f,l._tr_flush_block=function(c,x,U,N){var z,M,X=0;0<c.level?(c.strm.data_type===2&&(c.strm.data_type=function(K){var J,ut=4093624447;for(J=0;J<=31;J++,ut>>>=1)if(1&ut&&K.dyn_ltree[2*J]!==0)return a;if(K.dyn_ltree[18]!==0||K.dyn_ltree[20]!==0||K.dyn_ltree[26]!==0)return r;for(J=32;J<y;J++)if(K.dyn_ltree[2*J]!==0)return r;return a}(c)),wt(c,c.l_desc),wt(c,c.d_desc),X=function(K){var J;for(t(K,K.dyn_ltree,K.l_desc.max_code),t(K,K.dyn_dtree,K.d_desc.max_code),wt(K,K.bl_desc),J=m-1;3<=J&&K.bl_tree[2*G[J]+1]===0;J--);return K.opt_len+=3*(J+1)+5+5+4,J}(c),z=c.opt_len+3+7>>>3,(M=c.static_len+3+7>>>3)<=z&&(z=M)):z=M=U+5,U+4<=z&&x!==-1?f(c,x,U,N):c.strategy===4||M===z?(Y(c,2+(N?1:0),3),kt(c,tt,w)):(Y(c,4+(N?1:0),3),function(K,J,ut,at){var vt;for(Y(K,J-257,5),Y(K,ut-1,5),Y(K,at-4,4),vt=0;vt<at;vt++)Y(K,K.bl_tree[2*G[vt]+1],3);T(K,K.dyn_ltree,J-1),T(K,K.dyn_dtree,ut-1)}(c,c.l_desc.max_code+1,c.d_desc.max_code+1,X+1),kt(c,c.dyn_ltree,c.dyn_dtree)),st(c),N&&ot(c)},l._tr_tally=function(c,x,U){return c.pending_buf[c.d_buf+2*c.last_lit]=x>>>8&255,c.pending_buf[c.d_buf+2*c.last_lit+1]=255&x,c.pending_buf[c.l_buf+c.last_lit]=255&U,c.last_lit++,x===0?c.dyn_ltree[2*U]++:(c.matches++,x--,c.dyn_ltree[2*(e[U]+y+1)]++,c.dyn_dtree[2*E(x)]++),c.last_lit===c.lit_bufsize-1},l._tr_align=function(c){Y(c,2,3),q(c,S,tt),function(x){x.bi_valid===16?(Q(x,x.bi_buf),x.bi_buf=0,x.bi_valid=0):8<=x.bi_valid&&(x.pending_buf[x.pending++]=255&x.bi_buf,x.bi_buf>>=8,x.bi_valid-=8)}(c)}},{"../utils/common":41}],53:[function(n,A,l){A.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,A,l){(function(i){(function(a,r){if(!a.setImmediate){var d,p,v,y,_=1,o={},m=!1,s=a.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(a);h=h&&h.setTimeout?h:a,d={}.toString.call(a.process)==="[object process]"?function(C){process.nextTick(function(){g(C)})}:function(){if(a.postMessage&&!a.importScripts){var C=!0,D=a.onmessage;return a.onmessage=function(){C=!1},a.postMessage("","*"),a.onmessage=D,C}}()?(y="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",S,!1):a.attachEvent("onmessage",S),function(C){a.postMessage(y+C,"*")}):a.MessageChannel?((v=new MessageChannel).port1.onmessage=function(C){g(C.data)},function(C){v.port2.postMessage(C)}):s&&"onreadystatechange"in s.createElement("script")?(p=s.documentElement,function(C){var D=s.createElement("script");D.onreadystatechange=function(){g(C),D.onreadystatechange=null,p.removeChild(D),D=null},p.appendChild(D)}):function(C){setTimeout(g,0,C)},h.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var D=new Array(arguments.length-1),P=0;P<D.length;P++)D[P]=arguments[P+1];var R={callback:C,args:D};return o[_]=R,d(_),_++},h.clearImmediate=u}function u(C){delete o[C]}function g(C){if(m)setTimeout(g,0,C);else{var D=o[C];if(D){m=!0;try{(function(P){var R=P.callback,H=P.args;switch(H.length){case 0:R();break;case 1:R(H[0]);break;case 2:R(H[0],H[1]);break;case 3:R(H[0],H[1],H[2]);break;default:R.apply(r,H)}})(D)}finally{u(C),m=!1}}}}function S(C){C.source===a&&typeof C.data=="string"&&C.data.indexOf(y)===0&&g(+C.data.slice(y.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Ft<"u"?Ft:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Mt);const Je=Mt.exports;const Qe={name:"VerifyStep",props:{form:{type:Object}},emits:["on-success","on-close"],components:{RemoteHost:Nt,CodeHighlight:Zt},data(){return{hasInit:!1,host:"",deployForm:{deploy_host:null,keyDeployPath:"",pemDeployPath:"",reloadcmd:"service nginx force-reload"},rules:{deploy_host:[{message:"\u670D\u52A1\u5668\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],keyDeployPath:[{message:"\u79C1\u94A5\u90E8\u7F72\u8DEF\u5F84\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],pemDeployPath:[{message:"\u516C\u94A5\u90E8\u7F72\u8DEF\u5F84\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],reloadcmd:[{message:"\u91CD\u542F\u547D\u4EE4\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}]}}},computed:{domain_list(){return this.form.domains.join(" ")},nginxConfig(){return`server {
    listen 443 ssl;
    server_name ${this.domain_list};

    ssl_certificate_key ${this.deployForm.keyDeployPath};
    ssl_certificate ${this.deployForm.pemDeployPath};  
}`}},methods:{async getData(){console.log(this.form),this.deployForm.keyDeployPath=this.form.deploy_key_file||`/path/to/${this.form.domains[0]}.key`,this.deployForm.pemDeployPath=this.form.deploy_fullchain_file||`/path/to/${this.form.domains[0]}.pem`,this.deployForm.reloadcmd=this.form.deploy_reloadcmd||this.deployForm.reloadcmd,this.deployForm.deploy_host=this.form.deploy_host,this.deployForm.deploy_host||await this.getDomainHost(),this.hasInit=!0},async getDomainHost(){let b={domain:this.form.domains[0]};const k=await this.$http.getDomainHost(b);k.code==0?(this.host=k.data.host,this.host&&await this.getHost()):this.$msg.error(k.msg)},async getHost(){let b={host:this.host};const k=await this.$http.getHostList(b);k.data.list&&k.data.list.length>0&&(this.deployForm.deploy_host=k.data.list[0])},handleClose(){this.$emit("on-close")},async handleSubmit(){let b=this.$loading({fullscreen:!0}),k={issue_certificate_id:this.form.id};const n=await this.$http.renewCertificate(k);return n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg),this.$nextTick(()=>{b.close()}),n},downloadSSLKeyFile(){console.log(JSON.stringify(this.form,null,2));let b=new Blob([this.form.ssl_certificate_key],{type:"text/plain;charset=utf-8"}),k=this.form.domains[0];xt.saveAs(b,`${k}.key`)},async downloadSSLFile(){let b=this.form.domains[0];const k=new Je;k.file(`${b}.pem`,this.form.ssl_certificate),k.file(`${b}.key`,this.form.ssl_certificate_key),k.generateAsync({type:"blob"}).then(function(n){xt.saveAs(n,`${b}.zip`)})},async handleDeployVerifyFile(b){this.$refs.form.validate(k=>{if(k)this.confirmDeployVerifyFile(b);else return!1})},async confirmDeployVerifyFile(b){let k=this.$loading({fullscreen:!0}),n={issue_certificate_id:this.form.id,host_id:b.id,key_deploy_path:this.deployForm.keyDeployPath,pem_deploy_path:this.deployForm.pemDeployPath,reloadcmd:this.deployForm.reloadcmd};const A=await this.$http.deployCertificateFile(n);A.code==0?(this.$msg.success("\u90E8\u7F72\u6210\u529F"),this.$emit("on-success",A.data)):this.$msg.error(A.msg),this.$nextTick(()=>{k.close()})}},created(){this.getData()}},tr={class:"mo-form-detail"},er={class:"text-center mt-md"};function rr(b,k,n,A,l,i){const a=W("RemoteHost"),r=W("el-form-item"),d=W("el-input"),p=W("el-form"),v=W("Download"),y=W("el-icon"),_=W("el-link"),o=W("CodeHighlight"),m=W("el-button");return nt(),pt("div",null,[F(p,{ref:"form",model:l.deployForm,rules:l.rules,"label-width":"160px"},{default:j(()=>[F(r,{label:b.$t("\u670D\u52A1\u5668\u5730\u5740"),prop:"deploy_host"},{default:j(()=>[l.hasInit?(nt(),gt(a,{key:0,defaultKeyword:l.host,modelValue:l.deployForm.deploy_host,"onUpdate:modelValue":k[0]||(k[0]=s=>l.deployForm.deploy_host=s),onOnConfirm:i.handleDeployVerifyFile},null,8,["defaultKeyword","modelValue","onOnConfirm"])):Dt("",!0)]),_:1},8,["label"]),F(r,{label:b.$t("\u79C1\u94A5\u90E8\u7F72\u8DEF\u5F84"),prop:"keyDeployPath"},{default:j(()=>[F(d,{modelValue:l.deployForm.keyDeployPath,"onUpdate:modelValue":k[1]||(k[1]=s=>l.deployForm.keyDeployPath=s)},null,8,["modelValue"])]),_:1},8,["label"]),F(r,{label:b.$t("\u516C\u94A5\u90E8\u7F72\u8DEF\u5F84"),prop:"pemDeployPath"},{default:j(()=>[F(d,{modelValue:l.deployForm.pemDeployPath,"onUpdate:modelValue":k[2]||(k[2]=s=>l.deployForm.pemDeployPath=s)},null,8,["modelValue"])]),_:1},8,["label"]),F(r,{label:b.$t("\u91CD\u542F\u547D\u4EE4"),prop:"reloadcmd"},{default:j(()=>[F(d,{modelValue:l.deployForm.reloadcmd,"onUpdate:modelValue":k[3]||(k[3]=s=>l.deployForm.reloadcmd=s)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"]),lt("div",tr,[F(p,{"label-width":"130px"},{default:j(()=>[F(r,{label:b.$t("SSL\u8BC1\u4E66"),prop:"domain"},{default:j(()=>[F(_,{underline:!1,type:"primary",class:"mr-sm",onClick:i.downloadSSLFile},{default:j(()=>[F(y,null,{default:j(()=>[F(v)]),_:1}),bt(dt(b.$t("\u70B9\u51FB\u4E0B\u8F7D"))+"\uFF08.zip\uFF09",1)]),_:1},8,["onClick"])]),_:1},8,["label"]),F(r,{label:b.$t("Nginx\u914D\u7F6E"),prop:"domain"},{default:j(()=>[F(o,{value:i.nginxConfig},null,8,["value"])]),_:1},8,["label"])]),_:1}),lt("div",er,[F(m,{onClick:i.handleClose},{default:j(()=>[bt(dt(b.$t("\u5173\u95ED")),1)]),_:1},8,["onClick"])])])])}const ir=_t(Qe,[["render",rr],["__scopeId","data-v-3738a709"]]),nr={name:"IssueCertificateStep",props:{row:{type:Object},defaultActiveStep:{type:Number,default:0}},components:{DataForm:Wt,VerifyStep:Ke,RenewStep:Xe,DownloadStep:ir},data(){return{host:"",hasInit:!1,activeStep:0,issue_certificate_id:null,form:{id:null,domains:[],validation:"",token:"",status:"",ssl_certificate_key:"",ssl_certificate:"",deploy_key_file:"",deploy_fullchain_file:"",deploy_reloadcmd:"",deploy_host:null},setpList:[{title:this.$t("\u586B\u5199\u57DF\u540D")},{title:this.$t("\u9A8C\u8BC1\u57DF\u540D")},{title:this.$t("\u4E0B\u8F7D\u8BC1\u4E66")}]}},computed:{},methods:{async getData(){if(!this.issue_certificate_id)return;let b={issue_certificate_id:this.issue_certificate_id};const k=await this.$http.getIssueCertificateById(b);if(!!k.ok){for(let n in this.form)this.form[n]=k.data[n];this.activeStep=this.defaultActiveStep,k.data.ssl_certificate?this.activeStep=2:k.data.status=="valid"?this.activeStep=2:k.data.id?this.activeStep=1:this.activeStep=0}},handleIssueSuccess(b){this.issue_certificate_id=b.id,this.getData()},handleVerifySuccess(){this.getData()}},created(){this.row&&(this.issue_certificate_id=this.row.id),this.getData()}},sr={class:""},ar={class:"mt-md"};function or(b,k,n,A,l,i){const a=W("el-step"),r=W("el-steps"),d=W("DataForm"),p=W("VerifyStep"),v=W("DownloadStep");return nt(),pt("div",sr,[F(r,{active:l.activeStep,"align-center":"","finish-status":"success"},{default:j(()=>[(nt(!0),pt(Tt,null,Pt(l.setpList,y=>(nt(),gt(a,{title:y.title},null,8,["title"]))),256))]),_:1},8,["active"]),lt("div",ar,[l.activeStep==0?(nt(),gt(d,{key:0,onOnSuccess:i.handleIssueSuccess,onOnCancel:k[0]||(k[0]=y=>b.$emit("on-cancel"))},null,8,["onOnSuccess"])):l.activeStep==1?(nt(),gt(p,{key:1,form:l.form,onOnSuccess:i.handleVerifySuccess},null,8,["form","onOnSuccess"])):l.activeStep==2?(nt(),gt(v,{key:2,form:l.form,onOnClose:k[1]||(k[1]=y=>b.$emit("on-cancel"))},null,8,["form"])):Dt("",!0)])])}const lr=_t(nr,[["render",or]]),dr={name:"",props:{row:{type:Object,default:null},visible:{type:Boolean,default:!1}},emits:["update:visible"],components:{DataForm:Wt,IssueCertificateStep:lr},data(){return{}},computed:{dialogTitle(){return this.row?"\u7F16\u8F91":this.$t("\u7533\u8BF7SSL\u8BC1\u4E66")},dialogVisible:{get(){return this.visible},set(b){this.$emit("update:visible",b)}}},methods:{handleClose(){this.$emit("update:visible",!1)},handleOpen(){this.$emit("update:visible",!0)},handleSuccess(){this.handleClose(),this.$emit("on-success")},handleDialogClose(){this.$emit("on-close")}},created(){}};function ur(b,k,n,A,l,i){const a=W("IssueCertificateStep"),r=W("el-dialog");return nt(),gt(r,{title:b.$t("\u7533\u8BF7SSL\u8BC1\u4E66"),modelValue:i.dialogVisible,"onUpdate:modelValue":k[0]||(k[0]=d=>i.dialogVisible=d),width:"90%",center:"",top:"20px","append-to-body":"",onClose:i.handleDialogClose},{default:j(()=>[i.dialogVisible?(nt(),gt(a,{key:0,row:n.row,onOnCancel:i.handleClose,onOnSuccess:i.handleSuccess},null,8,["row","onOnCancel","onOnSuccess"])):Dt("",!0)]),_:1},8,["title","modelValue","onClose"])}const Kt=_t(dr,[["render",ur]]),cr={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{rules:{},form:{ssl_certificate:"",ssl_certificate_key:""}}},computed:{},methods:{async getData(){let b={issue_certificate_id:this.row.id};const k=await this.$http.getIssueCertificateById(b);if(k.ok)for(let n in this.form)this.form[n]=k.data[n]},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(b=>{if(b)this.confirmSubmit();else return!1})},async confirmSubmit(){let b=this.$loading({fullscreen:!0}),k={domains:this.form.domains.split(`
`)};this.row&&(k.id=this.row.id);const n=await this.$http.issueCertificate(k);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success",n.data)):this.$msg.error(n.msg),this.$nextTick(()=>{b.close()})}},created(){this.getData()}},hr={class:"text-center"};function fr(b,k,n,A,l,i){const a=W("el-input"),r=W("el-form-item"),d=W("el-form"),p=W("el-button");return nt(),pt("div",null,[F(d,{ref:"form",model:l.form,rules:l.rules,"label-width":"100px"},{default:j(()=>[F(r,{label:"id",prop:"id",style:{display:"none"}},{default:j(()=>[F(a,{type:"text",modelValue:l.form.id,"onUpdate:modelValue":k[0]||(k[0]=v=>l.form.id=v),placeholder:"id"},null,8,["modelValue"])]),_:1}),F(r,{label:"\u8BC1\u4E66\u6587\u4EF6",prop:"domains"},{default:j(()=>[F(a,{type:"textarea",modelValue:l.form.ssl_certificate,"onUpdate:modelValue":k[1]||(k[1]=v=>l.form.ssl_certificate=v),rows:10,spellcheck:!1,placeholder:"\u8BF7\u8F93\u5165\u57DF\u540D\u5217\u8868\uFF0C\u6BCF\u884C\u4E00\u4E2A"},null,8,["modelValue"])]),_:1}),F(r,{label:"\u8BC1\u4E66\u79C1\u94A5",prop:"domains"},{default:j(()=>[F(a,{type:"textarea",modelValue:l.form.ssl_certificate_key,"onUpdate:modelValue":k[2]||(k[2]=v=>l.form.ssl_certificate_key=v),rows:10,spellcheck:!1,placeholder:"\u8BF7\u8F93\u5165\u57DF\u540D\u5217\u8868\uFF0C\u6BCF\u884C\u4E00\u4E2A"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),lt("div",hr,[F(p,{onClick:i.handleCancel},{default:j(()=>[bt("\u5173 \u95ED")]),_:1},8,["onClick"])])])}const pr=_t(cr,[["render",fr]]),mr={name:"",props:{row:{type:Object,default:null},visible:{type:Boolean,default:!1}},emits:["update:visible"],components:{DataForm:pr},data(){return{}},computed:{dialogTitle(){return this.row?"\u7F16\u8F91":this.$t("\u7533\u8BF7SSL\u8BC1\u4E66")},dialogVisible:{get(){return this.visible},set(b){this.$emit("update:visible",b)}}},methods:{handleClose(){this.$emit("update:visible",!1)},handleOpen(){this.$emit("update:visible",!0)},handleSuccess(){this.handleClose(),this.$emit("on-success")},handleDialogClose(){this.$emit("on-close")}},created(){}};function _r(b,k,n,A,l,i){const a=W("DataForm"),r=W("el-dialog");return nt(),gt(r,{title:"SSL\u8BC1\u4E66",modelValue:i.dialogVisible,"onUpdate:modelValue":k[0]||(k[0]=d=>i.dialogVisible=d),width:"800px",center:"",top:"20px","append-to-body":"",onClose:i.handleDialogClose},{default:j(()=>[i.dialogVisible?(nt(),gt(a,{key:0,row:n.row,onOnCancel:i.handleClose,onOnSuccess:i.handleSuccess},null,8,["row","onOnCancel","onOnSuccess"])):Dt("",!0)]),_:1},8,["modelValue","onClose"])}const gr=_t(mr,[["render",_r]]),yr={name:"",components:{DataFormDialog:Kt,ConnectStatus:Ut,ExpireProgress:ee,CertificateDetailDialog:gr},props:{list:{type:Array}},emits:["on-close","on-success","selection-change"],computed:{},data(){return{currentRow:null,dialogVisible:!1,CertificateDetailDialogVisible:!1}},methods:{handleEditRow(b){this.currentRow=b,this.dialogVisible=!0},handleOpenDetail(b){this.currentRow=b,this.CertificateDetailDialogVisible=!0},async handleDeleteClick(b){let k={issue_certificate_id:b.id};const n=await this.$http.deleteCertificateById(k);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg)},async handleStatusChange(b){let k={id:b.id};const n=await this.$http.function(k);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg)},async handleRenewIssueCertificateById(b){let k=this.$loading({fullscreen:!0}),n={issue_certificate_id:b.id};const A=await this.$http.renewIssueCertificateById(n);A.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(A.msg),this.$nextTick(()=>{k.close()})},handleUpdateSuccess(){this.$emit("on-success")}},created(){}},br={style:{"margin-left":"4px"}},vr={class:"inline-flex items-center"},wr={class:"mr-[2px]"};function kr(b,k,n,A,l,i){const a=W("el-table-column"),r=W("ExpireProgress"),d=W("ConnectStatus"),p=W("el-link"),v=W("Warning"),y=W("el-icon"),_=W("el-tooltip"),o=W("Tickets"),m=W("Refresh"),s=W("el-popconfirm"),h=W("Delete"),u=W("el-table"),g=W("DataFormDialog"),S=W("CertificateDetailDialog");return nt(),pt("div",null,[F(u,{data:n.list,stripe:"",border:"",onSelectionChange:k[0]||(k[0]=C=>b.$emit("selection-change",C))},{default:j(()=>[F(a,{type:"selection","header-align":"center",align:"center",width:"40"}),F(a,{label:b.$t("\u57DF\u540D"),"header-align":"center",align:"center",prop:"domains"},{default:j(C=>[(nt(!0),pt(Tt,null,Pt(C.row.domains,D=>(nt(),pt("div",null,dt(D),1))),256))]),_:1},8,["label"]),F(a,{label:b.$t("SSL\u7B7E\u53D1\u65F6\u95F4"),"header-align":"center",align:"center",prop:"start_date",width:"120"},{default:j(C=>[lt("span",null,dt(C.row.start_date||"-"),1)]),_:1},8,["label"]),F(a,{label:b.$t("SSL\u8FC7\u671F\u65F6\u95F4"),"header-align":"center",align:"center",prop:"expire_date",width:"120"},{default:j(C=>[lt("span",null,dt(C.row.expire_date||"-"),1)]),_:1},8,["label"]),F(a,{label:b.$t("\u8BC1\u4E66\u5929\u6570"),"header-align":"center",align:"center",width:"110",sortable:"custom",prop:"expire_days"},{default:j(C=>[F(r,{startTime:C.row.start_time,endTime:C.row.expire_time},null,8,["startTime","endTime"])]),_:1},8,["label"]),F(a,{label:b.$t("\u72B6\u6001"),"header-align":"center",align:"center",prop:"status",width:"120"},{default:j(C=>[F(d,{value:C.row.show_status,onOnClick:D=>i.handleEditRow(C.row)},null,8,["value","onOnClick"]),F(p,{underline:!1,type:"primary",onClick:D=>i.handleEditRow(C.row)},{default:j(()=>[lt("span",br,dt(C.row.status_label||"-"),1)]),_:2},1032,["onClick"])]),_:1},8,["label"]),F(a,{label:b.$t("\u66F4\u65B0\u65F6\u95F4"),"header-align":"center",align:"center",width:"120",prop:"update_time_label"},{default:j(C=>[lt("span",null,dt(C.row.update_time_label||"-"),1)]),_:1},8,["label"]),F(a,{label:b.$t("\u81EA\u52A8\u7EED\u671F"),width:"120","header-align":"center",align:"center"},{header:j(()=>[F(_,{effect:"dark",content:"\u81EA\u52A8\u9A8C\u8BC1\u548C\u81EA\u52A8\u90E8\u7F72\u6210\u529F\u7684\u8BC1\u4E66\u624D\u4F1A\u81EA\u52A8\u7EED\u671F",placement:"top-start","show-after":800},{default:j(()=>[lt("div",vr,[lt("span",wr,dt(b.$t("\u81EA\u52A8\u7EED\u671F")),1),F(y,null,{default:j(()=>[F(v)]),_:1})])]),_:1})]),default:j(C=>[bt(dt(C.row.is_auto_renew?b.$t("\u662F"):b.$t("\u5426")),1)]),_:1},8,["label"]),F(a,{label:b.$t("\u67E5\u770B"),width:"60","header-align":"center",align:"center"},{default:j(C=>[F(p,{underline:!1,type:"primary",disabled:!C.row.has_ssl_certificate,onClick:D=>i.handleOpenDetail(C.row)},{default:j(()=>[F(y,null,{default:j(()=>[F(o)]),_:1})]),_:2},1032,["disabled","onClick"])]),_:1},8,["label"]),F(a,{label:b.$t("\u7EED\u671F"),width:"70",align:"center",prop:"tag"},{default:j(C=>[F(s,{title:"\u786E\u5B9A\u7EED\u671F\uFF1F",onConfirm:D=>i.handleRenewIssueCertificateById(C.row)},{reference:j(()=>[F(p,{underline:!1,type:"primary",disabled:!C.row.is_auto_renew},{default:j(()=>[F(y,null,{default:j(()=>[F(m)]),_:1})]),_:2},1032,["disabled"])]),_:2},1032,["onConfirm"])]),_:1},8,["label"]),F(a,{label:b.$t("\u5220\u9664"),width:"60",align:"center",prop:"tag"},{default:j(C=>[F(s,{title:`${b.$t("\u786E\u5B9A\u5220\u9664")}\uFF1F`,onConfirm:D=>i.handleDeleteClick(C.row)},{reference:j(()=>[F(p,{underline:!1,type:"danger"},{default:j(()=>[F(y,null,{default:j(()=>[F(h)]),_:1})]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["data"]),F(g,{visible:l.dialogVisible,"onUpdate:visible":k[1]||(k[1]=C=>l.dialogVisible=C),row:l.currentRow,defaultActiveStep:1,onOnSuccess:i.handleUpdateSuccess,onOnClose:k[2]||(k[2]=C=>b.$emit("on-close"))},null,8,["visible","row","onOnSuccess"]),F(S,{visible:l.CertificateDetailDialogVisible,"onUpdate:visible":k[3]||(k[3]=C=>l.CertificateDetailDialogVisible=C),row:l.currentRow},null,8,["visible","row"])])}const Sr=_t(yr,[["render",kr]]),Cr={name:"issue-certificate-list",props:{},components:{DataFormDialog:Kt,DataTable:Sr,DataCount:re},data(){return{list:[],total:0,page:1,size:20,keyword:"",selectedRows:[],loading:!0,dialogVisible:!1}},computed:{showBatchDeleteButton(){return!!(this.selectedRows&&this.selectedRows.length>0)}},methods:{resetData(){this.page=1,this.getData()},async getData(){this.loading=!0;let b={page:this.page,size:this.size,keyword:this.keyword};try{const k=await this.$http.getCertificateList(b);k.code==0&&(this.list=k.data.list.map(n=>(n.status=="pending"?(n.show_status=null,n.status_label=this.$t("\u672A\u9A8C\u8BC1")):n.status=="valid"?(n.show_status=!0,n.status_label=this.$t("\u5DF2\u9A8C\u8BC1")):(n.show_status=!1,n.status_label=this.$t("\u672A\u77E5")),n)),this.total=k.data.total)}catch(k){console.log(k)}finally{this.loading=!1}},handleAddRow(){this.dialogVisible=!0},handleAddSuccess(){this.resetData()},handleSearch(){this.resetData()},handleSelectionChange(b){this.selectedRows=b},async handleBatchDeleteConfirm(){let b=this.$loading({fullscreen:!0}),k={ids:this.selectedRows.map(n=>n.id)};try{const n=await this.$http.deleteCertificateByBatch(k);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.resetData()):this.$msg.error(n.msg)}catch(n){console.log(n)}finally{this.$nextTick(()=>{b.close()})}},async handleRefreshRow(b){let k={issue_certificate_id:b.id};const n=await this.$http.getIssueCertificateById(k);if(n.ok){let A=this.list.findIndex(l=>l.id==b.id);this.list.splice(A,1,n.data)}}},created(){this.getData()}},xr={class:"app-container"},Dr={class:"flex justify-between margin-bottom--20"},zr={class:"flex justify-between mt-sm items-center"};function Ar(b,k,n,A,l,i){const a=W("Plus"),r=W("el-icon"),d=W("el-button"),p=W("Search"),v=W("el-input"),y=W("DataCount"),_=W("Delete"),o=W("el-link"),m=W("el-popconfirm"),s=W("DataTable"),h=W("el-pagination"),u=W("DataFormDialog"),g=Xt("loading");return nt(),pt("div",xr,[lt("div",Dr,[F(d,{type:"primary",onClick:i.handleAddRow},{default:j(()=>[F(r,null,{default:j(()=>[F(a)]),_:1}),bt(dt(b.$t("\u7533\u8BF7")),1)]),_:1},8,["onClick"]),F(v,{class:"ml-sm",style:{width:"260px"},modelValue:l.keyword,"onUpdate:modelValue":k[0]||(k[0]=S=>l.keyword=S),placeholder:b.$t("\u641C\u7D22\u57DF\u540D"),clearable:"",onKeypress:Jt(i.handleSearch,["enter"]),onClear:i.handleSearch},{append:j(()=>[F(d,{onClick:i.handleSearch},{default:j(()=>[F(r,null,{default:j(()=>[F(p)]),_:1})]),_:1},8,["onClick"])]),_:1},8,["modelValue","placeholder","onKeypress","onClear"])]),lt("div",zr,[F(y,{value:l.total},null,8,["value"]),lt("div",null,[i.showBatchDeleteButton?(nt(),gt(m,{key:0,title:"\u786E\u5B9A\u5220\u9664\u9009\u4E2D\uFF1F",onConfirm:i.handleBatchDeleteConfirm},{reference:j(()=>[F(o,{underline:!1,type:"danger",class:"mr-sm"},{default:j(()=>[F(r,null,{default:j(()=>[F(_)]),_:1}),bt("\u6279\u91CF\u5220\u9664")]),_:1})]),_:1},8,["onConfirm"])):Dt("",!0)])]),Qt(F(s,{class:"mt-sm",list:l.list,onOnSuccess:i.resetData,onOnClose:i.resetData,onOnEditRow:b.handleEditRow,onSelectionChange:i.handleSelectionChange,onOnRefreshRow:i.handleRefreshRow},null,8,["list","onOnSuccess","onOnClose","onOnEditRow","onSelectionChange","onOnRefreshRow"]),[[g,l.loading]]),F(h,{class:"mt-md justify-center",background:"",layout:"total, prev, pager, next",total:l.total,"page-size":l.size,"onUpdate:pageSize":k[1]||(k[1]=S=>l.size=S),"current-page":l.page,"onUpdate:currentPage":k[2]||(k[2]=S=>l.page=S),onCurrentChange:i.getData},null,8,["total","page-size","current-page","onCurrentChange"]),F(u,{visible:l.dialogVisible,"onUpdate:visible":k[3]||(k[3]=S=>l.dialogVisible=S),onOnSuccess:i.handleAddSuccess,onOnClose:i.resetData},null,8,["visible","onOnSuccess","onOnClose"])])}const Ur=_t(Cr,[["render",Ar]]);export{Ur as default};
